{"ast":null,"code":"var _jsxFileName = \"/Users/J/crypto/dashboard/src/components/Governance/index.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { Header, Layout } from '@aragon/ui';\nimport { getImplementation, getStatusOf, getTokenBalance, getTokenTotalSupply } from '../../utils/infura';\nimport { QSDS } from '../../constants/tokens';\nimport { toTokenUnitsBN } from '../../utils/number';\nimport BigNumber from 'bignumber.js';\nimport GovernanceHeader from './Header';\nimport ProposeCandidate from './ProposeCandidate';\nimport CandidateHistory from './CandidateHistory';\nimport IconHeader from '../common/IconHeader';\nimport { canPropose } from '../../utils/gov';\nimport { Section } from '../common';\n\nfunction Governance({\n  user\n}) {\n  const [stake, setStake] = useState(new BigNumber(0));\n  const [totalStake, setTotalStake] = useState(new BigNumber(0));\n  const [userStatus, setUserStatus] = useState(0);\n  const [implementation, setImplementation] = useState('0x');\n  useEffect(() => {\n    if (user === '') {\n      setStake(new BigNumber(0));\n      setUserStatus(0);\n      return;\n    }\n\n    let isCancelled = false;\n\n    async function updateUserInfo() {\n      const [statusStr, stakeStr] = await Promise.all([getStatusOf(QSDS.addr, user), getTokenBalance(QSDS.addr, user)]);\n\n      if (!isCancelled) {\n        setStake(toTokenUnitsBN(stakeStr, QSDS.decimals));\n        setUserStatus(parseInt(statusStr, 10));\n      }\n    }\n\n    updateUserInfo();\n    const id = setInterval(updateUserInfo, 15000); // eslint-disable-next-line consistent-return\n\n    return () => {\n      isCancelled = true;\n      clearInterval(id);\n    };\n  }, [user]);\n  useEffect(() => {\n    let isCancelled = false;\n\n    async function updateUserInfo() {\n      const [totalStakeStr, implementationStr] = await Promise.all([getTokenTotalSupply(QSDS.addr), getImplementation(QSDS.addr)]);\n\n      if (!isCancelled) {\n        setTotalStake(toTokenUnitsBN(totalStakeStr, QSDS.decimals));\n        setImplementation(implementationStr);\n      }\n    }\n\n    updateUserInfo();\n    const id = setInterval(updateUserInfo, 15000); // eslint-disable-next-line consistent-return\n\n    return () => {\n      isCancelled = true;\n      clearInterval(id);\n    };\n  }, [user]);\n  return /*#__PURE__*/React.createElement(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(IconHeader, {\n    icon: /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fas fa-poll\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 25\n      }\n    }),\n    text: \"Governance\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(GovernanceHeader, {\n    stake: stake,\n    totalStake: totalStake,\n    accountStatus: userStatus,\n    implementation: implementation,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }\n  }), canPropose(stake, totalStake) ? /*#__PURE__*/React.createElement(ProposeCandidate, {\n    user: user,\n    stake: stake,\n    totalStake: totalStake,\n    accountStatus: userStatus,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }\n  }) : '', /*#__PURE__*/React.createElement(Section, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    primary: \"Candidate History\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(CandidateHistory, {\n    user: user,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  })));\n}\n\nexport default Governance;","map":{"version":3,"sources":["/Users/J/crypto/dashboard/src/components/Governance/index.tsx"],"names":["React","useState","useEffect","Header","Layout","getImplementation","getStatusOf","getTokenBalance","getTokenTotalSupply","QSDS","toTokenUnitsBN","BigNumber","GovernanceHeader","ProposeCandidate","CandidateHistory","IconHeader","canPropose","Section","Governance","user","stake","setStake","totalStake","setTotalStake","userStatus","setUserStatus","implementation","setImplementation","isCancelled","updateUserInfo","statusStr","stakeStr","Promise","all","addr","decimals","parseInt","id","setInterval","clearInterval","totalStakeStr","implementationStr"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Header, Layout } from '@aragon/ui';\n\nimport {\n  getImplementation,\n  getStatusOf,\n  getTokenBalance,\n  getTokenTotalSupply,\n} from '../../utils/infura';\nimport { QSDS } from '../../constants/tokens';\nimport { toTokenUnitsBN } from '../../utils/number';\nimport BigNumber from 'bignumber.js';\nimport GovernanceHeader from './Header';\nimport ProposeCandidate from './ProposeCandidate';\nimport CandidateHistory from './CandidateHistory';\nimport IconHeader from '../common/IconHeader';\nimport { canPropose } from '../../utils/gov';\nimport { Section } from '../common';\n\nfunction Governance({ user }: { user: string }) {\n  const [stake, setStake] = useState(new BigNumber(0));\n  const [totalStake, setTotalStake] = useState(new BigNumber(0));\n  const [userStatus, setUserStatus] = useState(0);\n  const [implementation, setImplementation] = useState('0x');\n\n  useEffect(() => {\n    if (user === '') {\n      setStake(new BigNumber(0));\n      setUserStatus(0);\n      return;\n    }\n    let isCancelled = false;\n\n    async function updateUserInfo() {\n      const [statusStr, stakeStr] = await Promise.all([\n        getStatusOf(QSDS.addr, user),\n        getTokenBalance(QSDS.addr, user),\n      ]);\n\n      if (!isCancelled) {\n        setStake(toTokenUnitsBN(stakeStr, QSDS.decimals));\n        setUserStatus(parseInt(statusStr, 10));\n      }\n    }\n    updateUserInfo();\n    const id = setInterval(updateUserInfo, 15000);\n\n    // eslint-disable-next-line consistent-return\n    return () => {\n      isCancelled = true;\n      clearInterval(id);\n    };\n  }, [user]);\n\n  useEffect(() => {\n    let isCancelled = false;\n\n    async function updateUserInfo() {\n      const [totalStakeStr, implementationStr] = await Promise.all([\n        getTokenTotalSupply(QSDS.addr),\n        getImplementation(QSDS.addr),\n      ]);\n\n      if (!isCancelled) {\n        setTotalStake(toTokenUnitsBN(totalStakeStr, QSDS.decimals));\n        setImplementation(implementationStr);\n      }\n    }\n    updateUserInfo();\n    const id = setInterval(updateUserInfo, 15000);\n\n    // eslint-disable-next-line consistent-return\n    return () => {\n      isCancelled = true;\n      clearInterval(id);\n    };\n  }, [user]);\n\n  return (\n    <Layout>\n      <IconHeader icon={<i className='fas fa-poll' />} text='Governance' />\n\n      <GovernanceHeader\n        stake={stake}\n        totalStake={totalStake}\n        accountStatus={userStatus}\n        implementation={implementation}\n      />\n\n      {canPropose(stake, totalStake) ? (\n        <ProposeCandidate\n          user={user}\n          stake={stake}\n          totalStake={totalStake}\n          accountStatus={userStatus}\n        />\n      ) : (\n        ''\n      )}\n\n      <Section>\n        <Header primary='Candidate History' />\n\n        <CandidateHistory user={user} />\n      </Section>\n    </Layout>\n  );\n}\n\nexport default Governance;\n"]},"metadata":{},"sourceType":"module"}