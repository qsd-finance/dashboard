{"ast":null,"code":"var _jsxFileName = \"/Users/J/crypto/dashboard/src/components/Regulation/RegulationHistory.tsx\";\nimport React, { useEffect, useState } from 'react';\nimport { DataView, useTheme } from '@aragon/ui';\nimport { getAllRegulations } from '../../utils/infura';\nimport { QSD, QSDS } from '../../constants/tokens';\nimport { formatBN, toTokenUnitsBN } from '../../utils/number';\nimport BigNumber from 'bignumber.js';\n\nfunction formatPrice(type, data) {\n  return type === 'NEUTRAL' ? '1.00' : formatBN(toTokenUnitsBN(new BigNumber(data.price), QSD.decimals), 3);\n}\n\nfunction formatDeltaBonded(type, data) {\n  return type === 'INCREASE' ? '+' + formatBN(toTokenUnitsBN(new BigNumber(data.newBonded), QSD.decimals), 2) : '+0.00';\n}\n\nfunction renderEntry({\n  type,\n  data\n}) {\n  return [data.epoch.toString(), formatPrice(type, data), formatDeltaBonded(type, data)];\n}\n\nfunction RegulationHistory({\n  user\n}) {\n  const theme = useTheme();\n  const isDark = theme._name === 'dark';\n  const [regulations, setRegulations] = useState([]);\n  const [page, setPage] = useState(0);\n  const [initialized, setInitialized] = useState(false); //Update User balances\n\n  useEffect(() => {\n    let isCancelled = false;\n\n    async function updateUserInfo() {\n      const [allRegulations] = await Promise.all([getAllRegulations(QSDS.addr)]);\n\n      if (!isCancelled) {\n        setRegulations(allRegulations);\n        setInitialized(true);\n      }\n    }\n\n    updateUserInfo();\n    const id = setInterval(updateUserInfo, 15000); // eslint-disable-next-line consistent-return\n\n    return () => {\n      isCancelled = true;\n      clearInterval(id);\n    };\n  }, [user]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: isDark ? 'table-container-dark' : undefined,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(DataView, {\n    fields: ['Epoch', 'Price', 'Δ Supply'],\n    status: initialized ? 'default' : 'loading',\n    entries: regulations,\n    entriesPerPage: 10,\n    page: page,\n    onPageChange: setPage,\n    renderEntry: renderEntry,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }\n  }));\n}\n\nexport default RegulationHistory;","map":{"version":3,"sources":["/Users/J/crypto/dashboard/src/components/Regulation/RegulationHistory.tsx"],"names":["React","useEffect","useState","DataView","useTheme","getAllRegulations","QSD","QSDS","formatBN","toTokenUnitsBN","BigNumber","formatPrice","type","data","price","decimals","formatDeltaBonded","newBonded","renderEntry","epoch","toString","RegulationHistory","user","theme","isDark","_name","regulations","setRegulations","page","setPage","initialized","setInitialized","isCancelled","updateUserInfo","allRegulations","Promise","all","addr","id","setInterval","clearInterval","undefined"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { DataView, useTheme } from '@aragon/ui';\n\nimport { getAllRegulations } from '../../utils/infura';\nimport { QSD, QSDS } from '../../constants/tokens';\nimport { formatBN, toTokenUnitsBN } from '../../utils/number';\nimport BigNumber from 'bignumber.js';\n\ntype RegulationHistoryProps = {\n  user: string;\n};\n\ntype Regulation = {\n  type: string;\n  data: RegulationEntry;\n};\n\ntype RegulationEntry = {\n  epoch: string;\n  price: string;\n  deltaRedeemable: string;\n  deltaDebt: string;\n  deltaBonded: string;\n};\n\nfunction formatPrice(type, data) {\n  return type === 'NEUTRAL'\n    ? '1.00'\n    : formatBN(toTokenUnitsBN(new BigNumber(data.price), QSD.decimals), 3);\n}\n\nfunction formatDeltaBonded(type, data) {\n  return type === 'INCREASE'\n    ? '+' +\n        formatBN(toTokenUnitsBN(new BigNumber(data.newBonded), QSD.decimals), 2)\n    : '+0.00';\n}\n\nfunction renderEntry({ type, data }: Regulation): string[] {\n  return [\n    data.epoch.toString(),\n    formatPrice(type, data),\n    formatDeltaBonded(type, data),\n  ];\n}\n\nfunction RegulationHistory({ user }: RegulationHistoryProps) {\n  const theme = useTheme();\n  const isDark = theme._name === 'dark';\n  const [regulations, setRegulations] = useState<Regulation[]>([]);\n  const [page, setPage] = useState(0);\n  const [initialized, setInitialized] = useState(false);\n\n  //Update User balances\n  useEffect(() => {\n    let isCancelled = false;\n\n    async function updateUserInfo() {\n      const [allRegulations] = await Promise.all([\n        getAllRegulations(QSDS.addr),\n      ]);\n\n      if (!isCancelled) {\n        setRegulations(allRegulations);\n        setInitialized(true);\n      }\n    }\n\n    updateUserInfo();\n    const id = setInterval(updateUserInfo, 15000);\n\n    // eslint-disable-next-line consistent-return\n    return () => {\n      isCancelled = true;\n      clearInterval(id);\n    };\n  }, [user]);\n\n  return (\n    <div className={isDark ? 'table-container-dark' : undefined}>\n      <DataView\n        fields={['Epoch', 'Price', 'Δ Supply']}\n        status={initialized ? 'default' : 'loading'}\n        entries={regulations}\n        entriesPerPage={10}\n        page={page}\n        onPageChange={setPage}\n        renderEntry={renderEntry}\n      />\n    </div>\n  );\n}\n\nexport default RegulationHistory;\n"]},"metadata":{},"sourceType":"module"}