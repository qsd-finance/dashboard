{"ast":null,"code":"var _jsxFileName = \"/Users/J/crypto/dashboard/src/components/Pool/Provide.tsx\";\nimport React, { useState } from 'react';\nimport { Tabs, Button, IconArrowUp, IconCirclePlus, useTheme } from '@aragon/ui';\nimport BigNumber from 'bignumber.js';\nimport { BalanceBlock, MaxButton, PriceSection, TopBorderSection } from '../common';\nimport { approve, providePool, providePoolOptimalOneSided } from '../../utils/web3';\nimport { isPos, toBaseUnitBN, toTokenUnitsBN } from '../../utils/number';\nimport { QSD, DAI } from '../../constants/tokens';\nimport { MAX_UINT256 } from '../../constants/values';\nimport BigNumberInput from '../common/BigNumberInput';\n\nfunction Provide({\n  poolAddress,\n  user,\n  rewarded,\n  pairBalanceQSD,\n  pairBalanceDAI,\n  userDAIBalance,\n  userDAIAllowance,\n  status\n}) {\n  const theme = useTheme();\n  const isDark = theme._name === 'dark';\n  const [useQSD, setUseQSD] = useState(0);\n  const [provideAmount, setProvideAmount] = useState(new BigNumber(0));\n  const [usdcAmount, setUsdcAmount] = useState(new BigNumber(0));\n  const DAIToQSDRatio = pairBalanceDAI.isZero() ? new BigNumber(1) : pairBalanceDAI.div(pairBalanceQSD);\n\n  const onChangeAmountQSD = amountQSD => {\n    if (!amountQSD) {\n      setProvideAmount(new BigNumber(0));\n      setUsdcAmount(new BigNumber(0));\n      return;\n    }\n\n    const amountQSDBN = new BigNumber(amountQSD);\n    setProvideAmount(amountQSDBN);\n    const amountQSDBU = toBaseUnitBN(amountQSDBN, QSD.decimals);\n    const newAmountDAI = toTokenUnitsBN(amountQSDBU.multipliedBy(DAIToQSDRatio).integerValue(BigNumber.ROUND_FLOOR), QSD.decimals);\n    setUsdcAmount(newAmountDAI);\n  };\n\n  return /*#__PURE__*/React.createElement(TopBorderSection, {\n    title: \"Provide\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: 'auto',\n      margin: '0 auto'\n    },\n    className: isDark ? 'tabs-container-dark' : undefined,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Tabs, {\n    items: ['Dual Supply (with DAI)', 'Single Supply'],\n    selected: useQSD,\n    onChange: setUseQSD,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }\n  })), userDAIAllowance.comparedTo(MAX_UINT256.dividedBy(2)) > 0 || useQSD ? /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexWrap: 'wrap'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flexBasis: '32%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(BalanceBlock, {\n    asset: \"Rewarded\",\n    balance: rewarded,\n    suffix: 'QSD',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flexBasis: '35%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flexBasis: '33%',\n      paddingTop: '2%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '60%',\n      minWidth: '6em'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(BigNumberInput, {\n    adornment: \"QSD\",\n    value: provideAmount,\n    setter: onChangeAmountQSD,\n    disabled: status === 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 19\n    }\n  }), !useQSD && /*#__PURE__*/React.createElement(PriceSection, {\n    label: \"Requires \",\n    amt: usdcAmount,\n    symbol: \" DAI\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(MaxButton, {\n    onClick: () => {\n      onChangeAmountQSD(rewarded);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 19\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '40%',\n      minWidth: '6em'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    wide: true,\n    icon: /*#__PURE__*/React.createElement(IconArrowUp, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 25\n      }\n    }),\n    label: \"Provide\",\n    onClick: () => {\n      if (useQSD) {\n        providePoolOptimalOneSided(poolAddress, toBaseUnitBN(provideAmount, QSD.decimals), hash => setProvideAmount(new BigNumber(0)));\n      } else {\n        providePool(poolAddress, toBaseUnitBN(provideAmount, QSD.decimals), hash => setProvideAmount(new BigNumber(0)));\n      }\n    },\n    disabled: poolAddress === '' || status !== 0 || !isPos(provideAmount) || usdcAmount.isGreaterThan(userDAIBalance),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 17\n    }\n  }))))) : /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexWrap: 'wrap'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flexBasis: '32%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(BalanceBlock, {\n    asset: \"Rewarded\",\n    balance: rewarded,\n    suffix: 'QSD',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flexBasis: '33%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(BalanceBlock, {\n    asset: \"DAI Balance\",\n    balance: userDAIBalance,\n    suffix: 'DAI',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flexBasis: '2%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      flexBasis: '33%',\n      paddingTop: '2%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    wide: true,\n    icon: /*#__PURE__*/React.createElement(IconCirclePlus, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 21\n      }\n    }),\n    label: \"Approve\",\n    onClick: () => {\n      approve(DAI.addr, poolAddress);\n    },\n    disabled: poolAddress === '' || user === '',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '100%',\n      paddingTop: '2%',\n      textAlign: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      opacity: 0.5\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 9\n    }\n  }, useQSD ? 'Zap your rewards directly' : 'Zap your rewards directly to LP by providing more DAI')));\n}\n\nexport default Provide;","map":{"version":3,"sources":["/Users/J/crypto/dashboard/src/components/Pool/Provide.tsx"],"names":["React","useState","Tabs","Button","IconArrowUp","IconCirclePlus","useTheme","BigNumber","BalanceBlock","MaxButton","PriceSection","TopBorderSection","approve","providePool","providePoolOptimalOneSided","isPos","toBaseUnitBN","toTokenUnitsBN","QSD","DAI","MAX_UINT256","BigNumberInput","Provide","poolAddress","user","rewarded","pairBalanceQSD","pairBalanceDAI","userDAIBalance","userDAIAllowance","status","theme","isDark","_name","useQSD","setUseQSD","provideAmount","setProvideAmount","usdcAmount","setUsdcAmount","DAIToQSDRatio","isZero","div","onChangeAmountQSD","amountQSD","amountQSDBN","amountQSDBU","decimals","newAmountDAI","multipliedBy","integerValue","ROUND_FLOOR","width","margin","undefined","comparedTo","dividedBy","display","flexWrap","flexBasis","paddingTop","minWidth","hash","isGreaterThan","addr","textAlign","opacity"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport {\n  Tabs,\n  Button,\n  IconArrowUp,\n  IconCirclePlus,\n  useTheme,\n} from '@aragon/ui';\nimport BigNumber from 'bignumber.js';\nimport {\n  BalanceBlock,\n  MaxButton,\n  PriceSection,\n  TopBorderSection,\n} from '../common';\nimport {\n  approve,\n  providePool,\n  providePoolOptimalOneSided,\n} from '../../utils/web3';\nimport { isPos, toBaseUnitBN, toTokenUnitsBN } from '../../utils/number';\nimport { QSD, DAI } from '../../constants/tokens';\nimport { MAX_UINT256 } from '../../constants/values';\nimport BigNumberInput from '../common/BigNumberInput';\n\ntype ProvideProps = {\n  poolAddress: string;\n  user: string;\n  rewarded: BigNumber;\n  pairBalanceQSD: BigNumber;\n  pairBalanceDAI: BigNumber;\n  userDAIBalance: BigNumber;\n  userDAIAllowance: BigNumber;\n  status: number;\n};\n\nfunction Provide({\n  poolAddress,\n  user,\n  rewarded,\n  pairBalanceQSD,\n  pairBalanceDAI,\n  userDAIBalance,\n  userDAIAllowance,\n  status,\n}: ProvideProps) {\n  const theme = useTheme();\n  const isDark = theme._name === 'dark';\n  const [useQSD, setUseQSD] = useState(0);\n  const [provideAmount, setProvideAmount] = useState(new BigNumber(0));\n  const [usdcAmount, setUsdcAmount] = useState(new BigNumber(0));\n\n  const DAIToQSDRatio = pairBalanceDAI.isZero()\n    ? new BigNumber(1)\n    : pairBalanceDAI.div(pairBalanceQSD);\n\n  const onChangeAmountQSD = (amountQSD) => {\n    if (!amountQSD) {\n      setProvideAmount(new BigNumber(0));\n      setUsdcAmount(new BigNumber(0));\n      return;\n    }\n\n    const amountQSDBN = new BigNumber(amountQSD);\n    setProvideAmount(amountQSDBN);\n\n    const amountQSDBU = toBaseUnitBN(amountQSDBN, QSD.decimals);\n    const newAmountDAI = toTokenUnitsBN(\n      amountQSDBU\n        .multipliedBy(DAIToQSDRatio)\n        .integerValue(BigNumber.ROUND_FLOOR),\n      QSD.decimals\n    );\n    setUsdcAmount(newAmountDAI);\n  };\n\n  return (\n    <TopBorderSection title='Provide'>\n      <div\n        style={{ width: 'auto', margin: '0 auto' }}\n        className={isDark ? 'tabs-container-dark' : undefined}\n      >\n        <Tabs\n          items={['Dual Supply (with DAI)', 'Single Supply']}\n          selected={useQSD}\n          onChange={setUseQSD}\n        />\n      </div>\n      {userDAIAllowance.comparedTo(MAX_UINT256.dividedBy(2)) > 0 || useQSD ? (\n        <div style={{ display: 'flex', flexWrap: 'wrap' }}>\n          {/* total rewarded */}\n          <div style={{ flexBasis: '32%' }}>\n            <BalanceBlock asset='Rewarded' balance={rewarded} suffix={'QSD'} />\n          </div>\n          <div style={{ flexBasis: '35%' }}></div>\n          {/* Provide liquidity using Pool rewards */}\n          <div style={{ flexBasis: '33%', paddingTop: '2%' }}>\n            <div style={{ display: 'flex' }}>\n              <div style={{ width: '60%', minWidth: '6em' }}>\n                <>\n                  <BigNumberInput\n                    adornment='QSD'\n                    value={provideAmount}\n                    setter={onChangeAmountQSD}\n                    disabled={status === 1}\n                  />\n                  {!useQSD && (\n                    <PriceSection\n                      label='Requires '\n                      amt={usdcAmount}\n                      symbol=' DAI'\n                    />\n                  )}\n                  <MaxButton\n                    onClick={() => {\n                      onChangeAmountQSD(rewarded);\n                    }}\n                  />\n                </>\n              </div>\n              <div style={{ width: '40%', minWidth: '6em' }}>\n                <Button\n                  wide\n                  icon={<IconArrowUp />}\n                  label='Provide'\n                  onClick={() => {\n                    if (useQSD) {\n                      providePoolOptimalOneSided(\n                        poolAddress,\n                        toBaseUnitBN(provideAmount, QSD.decimals),\n                        (hash) => setProvideAmount(new BigNumber(0))\n                      );\n                    } else {\n                      providePool(\n                        poolAddress,\n                        toBaseUnitBN(provideAmount, QSD.decimals),\n                        (hash) => setProvideAmount(new BigNumber(0))\n                      );\n                    }\n                  }}\n                  disabled={\n                    poolAddress === '' ||\n                    status !== 0 ||\n                    !isPos(provideAmount) ||\n                    usdcAmount.isGreaterThan(userDAIBalance)\n                  }\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      ) : (\n        <div style={{ display: 'flex', flexWrap: 'wrap' }}>\n          {/* total rewarded */}\n          <div style={{ flexBasis: '32%' }}>\n            <BalanceBlock asset='Rewarded' balance={rewarded} suffix={'QSD'} />\n          </div>\n          <div style={{ flexBasis: '33%' }}>\n            <BalanceBlock\n              asset='DAI Balance'\n              balance={userDAIBalance}\n              suffix={'DAI'}\n            />\n          </div>\n          <div style={{ flexBasis: '2%' }} />\n          {/* Approve Pool to spend DAI */}\n          <div style={{ flexBasis: '33%', paddingTop: '2%' }}>\n            <Button\n              wide\n              icon={<IconCirclePlus />}\n              label='Approve'\n              onClick={() => {\n                approve(DAI.addr, poolAddress);\n              }}\n              disabled={poolAddress === '' || user === ''}\n            />\n          </div>\n        </div>\n      )}\n      <div style={{ width: '100%', paddingTop: '2%', textAlign: 'center' }}>\n        <span style={{ opacity: 0.5 }}>\n          {useQSD\n            ? 'Zap your rewards directly'\n            : 'Zap your rewards directly to LP by providing more DAI'}\n        </span>\n      </div>\n    </TopBorderSection>\n  );\n}\n\nexport default Provide;\n"]},"metadata":{},"sourceType":"module"}