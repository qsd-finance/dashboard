{"ast":null,"code":"import _toConsumableArray from\"/Users/J/crypto/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/J/crypto/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/Users/J/crypto/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/J/crypto/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import Web3 from'web3';import BigNumber from'bignumber.js';import{Dao,UniswapV2Router02}from'../constants/contracts';import{QSD,UNI,DAI,QSDS}from'../constants/tokens';import{POOL_EXIT_LOCKUP_EPOCHS}from'../constants/values';import{formatBN,toTokenUnitsBN,toFloat}from'./number';import{getPoolLPAddress}from'./pool';var oracleAbi=require('../constants/abi/Oracle.json');var dollarAbi=require('../constants/abi/Dollar.json');var daoAbi=require('../constants/abi/Dao.json');var poolAbi=require('../constants/abi/Pool.json');var poolBondingAbi=require('../constants/abi/PoolBonding.json');var uniswapRouterAbi=require('../constants/abi/UniswapV2Router02.json');var uniswapPairAbi=require('../constants/abi/UniswapV2Pair.json');var web3;// eslint-disable-next-line no-undef\nif(window.ethereum!==undefined){// eslint-disable-next-line no-undef\nweb3=new Web3(ethereum);}/**\n *\n * @param {string} token address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getTokenBalance=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(token,account){var tokenContract;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(account==='')){_context.next=2;break;}return _context.abrupt(\"return\",'0');case 2:tokenContract=new web3.eth.Contract(dollarAbi,token);return _context.abrupt(\"return\",tokenContract.methods.balanceOf(account).call());case 4:case\"end\":return _context.stop();}}},_callee);}));return function getTokenBalance(_x,_x2){return _ref.apply(this,arguments);};}();export var getTokenTotalSupply=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(token){var tokenContract;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:tokenContract=new web3.eth.Contract(dollarAbi,token);return _context2.abrupt(\"return\",tokenContract.methods.totalSupply().call());case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function getTokenTotalSupply(_x3){return _ref2.apply(this,arguments);};}();/**\n *\n * @param {string} token\n * @param {string} account\n * @param {string} spender\n * @return {Promise<string>}\n */export var getTokenAllowance=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(token,account,spender){var tokenContract;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:tokenContract=new web3.eth.Contract(dollarAbi,token);return _context3.abrupt(\"return\",tokenContract.methods.allowance(account,spender).call());case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function getTokenAllowance(_x4,_x5,_x6){return _ref3.apply(this,arguments);};}();// QSD Protocol\n/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getBalanceBonded=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dao,account){var daoContract;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!(account==='')){_context4.next=2;break;}return _context4.abrupt(\"return\",'0');case 2:daoContract=new web3.eth.Contract(daoAbi,dao);return _context4.abrupt(\"return\",daoContract.methods.balanceOfBonded(account).call());case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function getBalanceBonded(_x7,_x8){return _ref4.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getBalanceOfStaged=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dao,account){var daoContract;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context5.abrupt(\"return\",daoContract.methods.balanceOfStaged(account).call());case 2:case\"end\":return _context5.stop();}}},_callee5);}));return function getBalanceOfStaged(_x9,_x10){return _ref5.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getStatusOf=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(dao,account){var daoContract;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context6.abrupt(\"return\",daoContract.methods.statusOf(account).call());case 2:case\"end\":return _context6.stop();}}},_callee6);}));return function getStatusOf(_x11,_x12){return _ref6.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getFluidUntil=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(dao,account){var daoContract;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context7.abrupt(\"return\",daoContract.methods.fluidUntil(account).call());case 2:case\"end\":return _context7.stop();}}},_callee7);}));return function getFluidUntil(_x13,_x14){return _ref7.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getLockedUntil=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(dao,account){var daoContract;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context8.abrupt(\"return\",daoContract.methods.lockedUntil(account).call());case 2:case\"end\":return _context8.stop();}}},_callee8);}));return function getLockedUntil(_x15,_x16){return _ref8.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */export var getEpoch=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(dao){var daoContract;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context9.abrupt(\"return\",daoContract.methods.epoch().call());case 2:case\"end\":return _context9.stop();}}},_callee9);}));return function getEpoch(_x17){return _ref9.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */export var getEpochTime=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(dao){var daoContract;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context10.abrupt(\"return\",daoContract.methods.epochTime().call());case 2:case\"end\":return _context10.stop();}}},_callee10);}));return function getEpochTime(_x18){return _ref10.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */export var getTotalDebt=/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(dao){var daoContract;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context11.abrupt(\"return\",daoContract.methods.totalDebt().call());case 2:case\"end\":return _context11.stop();}}},_callee11);}));return function getTotalDebt(_x19){return _ref11.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */export var getTotalClaimable=/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(dao){var poolContract;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:poolContract=new web3.eth.Contract(poolAbi,dao);return _context12.abrupt(\"return\",poolContract.methods.totalClaimable().call());case 2:case\"end\":return _context12.stop();}}},_callee12);}));return function getTotalClaimable(_x20){return _ref12.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */export var getTotalRewarded=/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(dao){var poolContract;return _regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:poolContract=new web3.eth.Contract(poolAbi,dao);return _context13.abrupt(\"return\",poolContract.methods.totalRewarded().call());case 2:case\"end\":return _context13.stop();}}},_callee13);}));return function getTotalRewarded(_x21){return _ref13.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */export var getTotalCoupons=/*#__PURE__*/function(){var _ref14=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee14(dao){var daoContract;return _regeneratorRuntime.wrap(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context14.abrupt(\"return\",daoContract.methods.totalCoupons().call());case 2:case\"end\":return _context14.stop();}}},_callee14);}));return function getTotalCoupons(_x22){return _ref14.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */export var getTotalCouponsUnderlying=/*#__PURE__*/function(){var _ref15=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee15(dao){var daoContract;return _regeneratorRuntime.wrap(function _callee15$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context15.abrupt(\"return\",daoContract.methods.totalCouponUnderlying().call());case 2:case\"end\":return _context15.stop();}}},_callee15);}));return function getTotalCouponsUnderlying(_x23){return _ref15.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */export var getTotalBonded=/*#__PURE__*/function(){var _ref16=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee16(dao){var daoContract;return _regeneratorRuntime.wrap(function _callee16$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context16.abrupt(\"return\",daoContract.methods.totalBonded().call());case 2:case\"end\":return _context16.stop();}}},_callee16);}));return function getTotalBonded(_x24){return _ref16.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */export var getTotalStaged=/*#__PURE__*/function(){var _ref17=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee17(dao){var daoContract;return _regeneratorRuntime.wrap(function _callee17$(_context17){while(1){switch(_context17.prev=_context17.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context17.abrupt(\"return\",daoContract.methods.totalStaged().call());case 2:case\"end\":return _context17.stop();}}},_callee17);}));return function getTotalStaged(_x25){return _ref17.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {number} epoch number\n * @return {Promise<string>}\n */export var getTotalBondedAt=/*#__PURE__*/function(){var _ref18=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee18(dao,epoch){var daoContract;return _regeneratorRuntime.wrap(function _callee18$(_context18){while(1){switch(_context18.prev=_context18.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context18.abrupt(\"return\",daoContract.methods.totalBondedAt(epoch).call());case 2:case\"end\":return _context18.stop();}}},_callee18);}));return function getTotalBondedAt(_x26,_x27){return _ref18.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string} candidate address\n * @return {Promise<string>}\n */export var getApproveFor=/*#__PURE__*/function(){var _ref19=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee19(dao,candidate){var daoContract;return _regeneratorRuntime.wrap(function _callee19$(_context19){while(1){switch(_context19.prev=_context19.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context19.abrupt(\"return\",daoContract.methods.approveFor(candidate).call());case 2:case\"end\":return _context19.stop();}}},_callee19);}));return function getApproveFor(_x28,_x29){return _ref19.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string} candidate address\n * @return {Promise<string>}\n */export var getRejectFor=/*#__PURE__*/function(){var _ref20=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee20(dao,candidate){var daoContract;return _regeneratorRuntime.wrap(function _callee20$(_context20){while(1){switch(_context20.prev=_context20.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context20.abrupt(\"return\",daoContract.methods.rejectFor(candidate).call());case 2:case\"end\":return _context20.stop();}}},_callee20);}));return function getRejectFor(_x30,_x31){return _ref20.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string} candidate address\n * @return {Promise<string>}\n */export var getStartFor=/*#__PURE__*/function(){var _ref21=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee21(dao,candidate){var daoContract;return _regeneratorRuntime.wrap(function _callee21$(_context21){while(1){switch(_context21.prev=_context21.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context21.abrupt(\"return\",daoContract.methods.startFor(candidate).call());case 2:case\"end\":return _context21.stop();}}},_callee21);}));return function getStartFor(_x32,_x33){return _ref21.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string} candidate address\n * @return {Promise<string>}\n */export var getPeriodFor=/*#__PURE__*/function(){var _ref22=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee22(dao,candidate){var daoContract;return _regeneratorRuntime.wrap(function _callee22$(_context22){while(1){switch(_context22.prev=_context22.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context22.abrupt(\"return\",daoContract.methods.periodFor(candidate).call());case 2:case\"end\":return _context22.stop();}}},_callee22);}));return function getPeriodFor(_x34,_x35){return _ref22.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string} candidate address\n * @return {Promise<boolean>}\n */export var getIsInitialized=/*#__PURE__*/function(){var _ref23=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee23(dao,candidate){var daoContract;return _regeneratorRuntime.wrap(function _callee23$(_context23){while(1){switch(_context23.prev=_context23.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context23.abrupt(\"return\",daoContract.methods.isInitialized(candidate).call());case 2:case\"end\":return _context23.stop();}}},_callee23);}));return function getIsInitialized(_x36,_x37){return _ref23.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @param {string} candidate address\n * @return {Promise<string>}\n */export var getRecordedVote=/*#__PURE__*/function(){var _ref24=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee24(dao,account,candidate){var daoContract;return _regeneratorRuntime.wrap(function _callee24$(_context24){while(1){switch(_context24.prev=_context24.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context24.abrupt(\"return\",daoContract.methods.recordedVote(account,candidate).call());case 2:case\"end\":return _context24.stop();}}},_callee24);}));return function getRecordedVote(_x38,_x39,_x40){return _ref24.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @param {number} epoch number\n * @return {Promise<string>}\n */export var getBalanceOfCoupons=/*#__PURE__*/function(){var _ref25=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee25(dao,account,epoch){var daoContract;return _regeneratorRuntime.wrap(function _callee25$(_context25){while(1){switch(_context25.prev=_context25.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context25.abrupt(\"return\",daoContract.methods.balanceOfCoupons(account,epoch).call());case 2:case\"end\":return _context25.stop();}}},_callee25);}));return function getBalanceOfCoupons(_x41,_x42,_x43){return _ref25.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @param {number[]} epochs number[]\n * @return {Promise<string[]>}\n */export var getBatchBalanceOfCoupons=/*#__PURE__*/function(){var _ref26=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee26(dao,account,epochs){var calls;return _regeneratorRuntime.wrap(function _callee26$(_context26){while(1){switch(_context26.prev=_context26.next){case 0:calls=epochs.map(function(epoch){return getBalanceOfCoupons(dao,account,epoch);});return _context26.abrupt(\"return\",Promise.all(calls));case 2:case\"end\":return _context26.stop();}}},_callee26);}));return function getBatchBalanceOfCoupons(_x44,_x45,_x46){return _ref26.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @param {number} epoch number\n * @return {Promise<string>}\n */export var getBalanceOfCouponsUnderlying=/*#__PURE__*/function(){var _ref27=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee27(dao,account,epoch){var daoContract;return _regeneratorRuntime.wrap(function _callee27$(_context27){while(1){switch(_context27.prev=_context27.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context27.abrupt(\"return\",daoContract.methods.balanceOfCouponUnderlying(account,epoch).call());case 2:case\"end\":return _context27.stop();}}},_callee27);}));return function getBalanceOfCouponsUnderlying(_x47,_x48,_x49){return _ref27.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @param {number[]} epochs number[]\n * @return {Promise<string[]>}\n */export var getBatchBalanceOfCouponsUnderlying=/*#__PURE__*/function(){var _ref28=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee28(dao,account,epochs){var calls;return _regeneratorRuntime.wrap(function _callee28$(_context28){while(1){switch(_context28.prev=_context28.next){case 0:calls=epochs.map(function(epoch){return getBalanceOfCouponsUnderlying(dao,account,epoch);});return _context28.abrupt(\"return\",Promise.all(calls));case 2:case\"end\":return _context28.stop();}}},_callee28);}));return function getBatchBalanceOfCouponsUnderlying(_x50,_x51,_x52){return _ref28.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {number} epoch address\n * @return {Promise<string>}\n */export var getOutstandingCoupons=/*#__PURE__*/function(){var _ref29=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee29(dao,epoch){var daoContract;return _regeneratorRuntime.wrap(function _callee29$(_context29){while(1){switch(_context29.prev=_context29.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context29.abrupt(\"return\",daoContract.methods.outstandingCoupons(epoch).call());case 2:case\"end\":return _context29.stop();}}},_callee29);}));return function getOutstandingCoupons(_x53,_x54){return _ref29.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {number} epoch number\n * @return {Promise<string>}\n */export var getCouponsExpiration=/*#__PURE__*/function(){var _ref30=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee30(dao,epoch){var daoContract;return _regeneratorRuntime.wrap(function _callee30$(_context30){while(1){switch(_context30.prev=_context30.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context30.abrupt(\"return\",daoContract.methods.couponsExpiration(epoch).call());case 2:case\"end\":return _context30.stop();}}},_callee30);}));return function getCouponsExpiration(_x55,_x56){return _ref30.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {number[]} epochs number[]\n * @return {Promise<string[]>}\n */export var getBatchCouponsExpiration=/*#__PURE__*/function(){var _ref31=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee31(dao,epochs){var calls;return _regeneratorRuntime.wrap(function _callee31$(_context31){while(1){switch(_context31.prev=_context31.next){case 0:calls=epochs.map(function(epoch){return getCouponsExpiration(dao,epoch);});return _context31.abrupt(\"return\",Promise.all(calls));case 2:case\"end\":return _context31.stop();}}},_callee31);}));return function getBatchCouponsExpiration(_x57,_x58){return _ref31.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @param {string|BigNumber} amount uint256\n * @return {Promise<string>}\n */export var getCouponPremium=/*#__PURE__*/function(){var _ref32=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee32(dao,amount){var daoContract;return _regeneratorRuntime.wrap(function _callee32$(_context32){while(1){switch(_context32.prev=_context32.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context32.abrupt(\"return\",daoContract.methods.couponPremium(new BigNumber(amount).toFixed()).call());case 2:case\"end\":return _context32.stop();}}},_callee32);}));return function getCouponPremium(_x59,_x60){return _ref32.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */export var getImplementation=/*#__PURE__*/function(){var _ref33=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee33(dao){var daoContract;return _regeneratorRuntime.wrap(function _callee33$(_context33){while(1){switch(_context33.prev=_context33.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context33.abrupt(\"return\",daoContract.methods.implementation().call());case 2:case\"end\":return _context33.stop();}}},_callee33);}));return function getImplementation(_x61){return _ref33.apply(this,arguments);};}();/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */export var getPoolBonding=/*#__PURE__*/function(){var _ref34=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee34(dao){var daoContract;return _regeneratorRuntime.wrap(function _callee34$(_context34){while(1){switch(_context34.prev=_context34.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context34.abrupt(\"return\",daoContract.methods.poolBonding().call());case 2:case\"end\":return _context34.stop();}}},_callee34);}));return function getPoolBonding(_x62){return _ref34.apply(this,arguments);};}();export var getPoolLP=/*#__PURE__*/function(){var _ref35=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee35(dao){var daoContract;return _regeneratorRuntime.wrap(function _callee35$(_context35){while(1){switch(_context35.prev=_context35.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context35.abrupt(\"return\",daoContract.methods.poolLP().call());case 2:case\"end\":return _context35.stop();}}},_callee35);}));return function getPoolLP(_x63){return _ref35.apply(this,arguments);};}();export var getPoolGov=/*#__PURE__*/function(){var _ref36=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee36(dao){var daoContract;return _regeneratorRuntime.wrap(function _callee36$(_context36){while(1){switch(_context36.prev=_context36.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);return _context36.abrupt(\"return\",daoContract.methods.poolGov().call());case 2:case\"end\":return _context36.stop();}}},_callee36);}));return function getPoolGov(_x64){return _ref36.apply(this,arguments);};}();/**\n *\n * @param {string} dao\n * @param {string} account\n * @return {Promise<any[]>}\n */export var getCouponEpochs=/*#__PURE__*/function(){var _ref37=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee37(dao,account){var daoContract,purchaseP,transferP,_yield$Promise$all,_yield$Promise$all2,bought,given,events,couponEpochs;return _regeneratorRuntime.wrap(function _callee37$(_context37){while(1){switch(_context37.prev=_context37.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);purchaseP=daoContract.getPastEvents('CouponPurchase',{filter:{account:account},fromBlock:0});transferP=daoContract.getPastEvents('CouponTransfer',{filter:{to:account},fromBlock:0});_context37.next=5;return Promise.all([purchaseP,transferP]);case 5:_yield$Promise$all=_context37.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);bought=_yield$Promise$all2[0];given=_yield$Promise$all2[1];events=bought.map(function(e){return{epoch:e.returnValues.epoch,amount:e.returnValues.couponAmount};}).concat(given.map(function(e){return{epoch:e.returnValues.epoch,amount:0};}));couponEpochs=_toConsumableArray(events.reduce(function(map,event){var epoch=event.epoch,amount=event.amount;var prev=map.get(epoch);if(prev){map.set(epoch,{epoch:epoch,coupons:prev.coupons.plus(new BigNumber(amount))});}else{map.set(epoch,{epoch:epoch,coupons:new BigNumber(amount)});}return map;},new Map()).values());return _context37.abrupt(\"return\",couponEpochs.sort(function(a,b){return a-b;}));case 12:case\"end\":return _context37.stop();}}},_callee37);}));return function getCouponEpochs(_x65,_x66){return _ref37.apply(this,arguments);};}();/**\n *\n * @param {string} dao\n * @return {Promise<any[]>}\n */export var getAllProposals=/*#__PURE__*/function(){var _ref38=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee38(dao){var daoContract,payload;return _regeneratorRuntime.wrap(function _callee38$(_context38){while(1){switch(_context38.prev=_context38.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);_context38.next=3;return daoContract.getPastEvents('Proposal',{fromBlock:0});case 3:payload=_context38.sent.map(function(event){var prop=event.returnValues;prop.blockNumber=event.blockNumber;return prop;});return _context38.abrupt(\"return\",payload.sort(function(a,b){return b.blockNumber-a.blockNumber;}));case 5:case\"end\":return _context38.stop();}}},_callee38);}));return function getAllProposals(_x67){return _ref38.apply(this,arguments);};}();/**\n *\n * @param {string} dao\n * @return {Promise<any[]>}\n */export var getAllRegulations=/*#__PURE__*/function(){var _ref39=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee39(dao){var daoContract,increaseP,decreaseP,neutralP,_yield$Promise$all3,_yield$Promise$all4,increase,decrease,neutral,events;return _regeneratorRuntime.wrap(function _callee39$(_context39){while(1){switch(_context39.prev=_context39.next){case 0:daoContract=new web3.eth.Contract(daoAbi,dao);increaseP=daoContract.getPastEvents('SupplyIncrease',{fromBlock:0});decreaseP=daoContract.getPastEvents('SupplyDecrease',{fromBlock:0});neutralP=daoContract.getPastEvents('SupplyNeutral',{fromBlock:0});_context39.next=6;return Promise.all([increaseP,decreaseP,neutralP]);case 6:_yield$Promise$all3=_context39.sent;_yield$Promise$all4=_slicedToArray(_yield$Promise$all3,3);increase=_yield$Promise$all4[0];decrease=_yield$Promise$all4[1];neutral=_yield$Promise$all4[2];events=increase.map(function(e){return{type:'INCREASE',data:e.returnValues};}).concat(decrease.map(function(e){return{type:'DECREASE',data:e.returnValues};})).concat(neutral.map(function(e){return{type:'NEUTRAL',data:e.returnValues};}));return _context39.abrupt(\"return\",events.sort(function(a,b){return b.data.epoch-a.data.epoch;}));case 13:case\"end\":return _context39.stop();}}},_callee39);}));return function getAllRegulations(_x68){return _ref39.apply(this,arguments);};}();// Uniswap Protocol\nexport var getCost=/*#__PURE__*/function(){var _ref40=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee40(amount){var exchange,_yield$exchange$metho,_yield$exchange$metho2,inputAmount,_;return _regeneratorRuntime.wrap(function _callee40$(_context40){while(1){switch(_context40.prev=_context40.next){case 0:exchange=new web3.eth.Contract(uniswapRouterAbi,UniswapV2Router02);// eslint-disable-next-line no-unused-vars\n_context40.next=3;return exchange.methods.getAmountsIn(new BigNumber(amount).toFixed(),[DAI.addr,QSD.addr]).call();case 3:_yield$exchange$metho=_context40.sent;_yield$exchange$metho2=_slicedToArray(_yield$exchange$metho,2);inputAmount=_yield$exchange$metho2[0];_=_yield$exchange$metho2[1];return _context40.abrupt(\"return\",inputAmount);case 8:case\"end\":return _context40.stop();}}},_callee40);}));return function getCost(_x69){return _ref40.apply(this,arguments);};}();export var getProceeds=/*#__PURE__*/function(){var _ref41=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee41(amount){var exchange,_yield$exchange$metho3,_yield$exchange$metho4,_,outputAmount;return _regeneratorRuntime.wrap(function _callee41$(_context41){while(1){switch(_context41.prev=_context41.next){case 0:exchange=new web3.eth.Contract(uniswapRouterAbi,UniswapV2Router02);// eslint-disable-next-line no-unused-vars\n_context41.next=3;return exchange.methods.getAmountsOut(new BigNumber(amount).toFixed(),[QSD.addr,DAI.addr]).call();case 3:_yield$exchange$metho3=_context41.sent;_yield$exchange$metho4=_slicedToArray(_yield$exchange$metho3,2);_=_yield$exchange$metho4[0];outputAmount=_yield$exchange$metho4[1];return _context41.abrupt(\"return\",outputAmount);case 8:case\"end\":return _context41.stop();}}},_callee41);}));return function getProceeds(_x70){return _ref41.apply(this,arguments);};}();export var getReserves=/*#__PURE__*/function(){var _ref42=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee42(){var exchange;return _regeneratorRuntime.wrap(function _callee42$(_context42){while(1){switch(_context42.prev=_context42.next){case 0:exchange=new web3.eth.Contract(uniswapPairAbi,UNI.addr);return _context42.abrupt(\"return\",exchange.methods.getReserves().call());case 2:case\"end\":return _context42.stop();}}},_callee42);}));return function getReserves(){return _ref42.apply(this,arguments);};}();export var getInstantaneousQSDPrice=/*#__PURE__*/function(){var _ref43=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee43(){var _yield$Promise$all5,_yield$Promise$all6,reserve,token0,token0Balance,token1Balance;return _regeneratorRuntime.wrap(function _callee43$(_context43){while(1){switch(_context43.prev=_context43.next){case 0:_context43.next=2;return Promise.all([getReserves(),getToken0()]);case 2:_yield$Promise$all5=_context43.sent;_yield$Promise$all6=_slicedToArray(_yield$Promise$all5,2);reserve=_yield$Promise$all6[0];token0=_yield$Promise$all6[1];token0Balance=new BigNumber(reserve.reserve0);token1Balance=new BigNumber(reserve.reserve1);if(!(token0.toLowerCase()===DAI.addr.toLowerCase())){_context43.next=10;break;}return _context43.abrupt(\"return\",token0Balance.multipliedBy(new BigNumber(10).pow(18)).dividedBy(token1Balance));case 10:return _context43.abrupt(\"return\",token1Balance.multipliedBy(new BigNumber(10).pow(18)).dividedBy(token0Balance));case 11:case\"end\":return _context43.stop();}}},_callee43);}));return function getInstantaneousQSDPrice(){return _ref43.apply(this,arguments);};}();export var getUniswapLiquidity=/*#__PURE__*/function(){var _ref44=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee44(){var _yield$Promise$all7,_yield$Promise$all8,reserve,token0,token0Balance,token1Balance;return _regeneratorRuntime.wrap(function _callee44$(_context44){while(1){switch(_context44.prev=_context44.next){case 0:_context44.next=2;return Promise.all([getReserves(),getToken0()]);case 2:_yield$Promise$all7=_context44.sent;_yield$Promise$all8=_slicedToArray(_yield$Promise$all7,2);reserve=_yield$Promise$all8[0];token0=_yield$Promise$all8[1];token0Balance=new BigNumber(reserve.reserve0);token1Balance=new BigNumber(reserve.reserve1);if(!(token0.toLowerCase()===DAI.addr.toLowerCase())){_context44.next=10;break;}return _context44.abrupt(\"return\",{dai:token0Balance,qsd:token1Balance});case 10:return _context44.abrupt(\"return\",{dai:token1Balance,qsd:token0Balance});case 11:case\"end\":return _context44.stop();}}},_callee44);}));return function getUniswapLiquidity(){return _ref44.apply(this,arguments);};}();export var getUserLPWallet=/*#__PURE__*/function(){var _ref45=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee45(user){var _yield$Promise$all9,_yield$Promise$all10,reserve,token0,uniTotalSupplyStr,uniBondedSupplyStr,token0Balance,token1Balance,ratio;return _regeneratorRuntime.wrap(function _callee45$(_context45){while(1){switch(_context45.prev=_context45.next){case 0:_context45.next=2;return Promise.all([getReserves(),getToken0()]);case 2:_yield$Promise$all9=_context45.sent;_yield$Promise$all10=_slicedToArray(_yield$Promise$all9,2);reserve=_yield$Promise$all10[0];token0=_yield$Promise$all10[1];_context45.next=8;return getTokenTotalSupply(UNI.addr);case 8:uniTotalSupplyStr=_context45.sent;_context45.next=11;return getTokenBalance(UNI.addr,user);case 11:uniBondedSupplyStr=_context45.sent;token0Balance=toFloat(toTokenUnitsBN(reserve.reserve0,18));token1Balance=toFloat(toTokenUnitsBN(reserve.reserve1,18));ratio=toFloat(toTokenUnitsBN(uniBondedSupplyStr,18))/toFloat(toTokenUnitsBN(uniTotalSupplyStr,18));if(!(token0.toLowerCase()===DAI.addr.toLowerCase())){_context45.next=17;break;}return _context45.abrupt(\"return\",{dai:token0Balance*ratio,qsd:token1Balance*ratio});case 17:return _context45.abrupt(\"return\",{dai:token1Balance*ratio,qsd:token0Balance*ratio});case 18:case\"end\":return _context45.stop();}}},_callee45);}));return function getUserLPWallet(_x71){return _ref45.apply(this,arguments);};}();export var getUserLPBonded=/*#__PURE__*/function(){var _ref46=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee46(user){var _yield$Promise$all11,_yield$Promise$all12,reserve,token0,uniTotalSupplyStr,uniBondedSupplyStr,token0Balance,token1Balance,ratio;return _regeneratorRuntime.wrap(function _callee46$(_context46){while(1){switch(_context46.prev=_context46.next){case 0:_context46.next=2;return Promise.all([getReserves(),getToken0()]);case 2:_yield$Promise$all11=_context46.sent;_yield$Promise$all12=_slicedToArray(_yield$Promise$all11,2);reserve=_yield$Promise$all12[0];token0=_yield$Promise$all12[1];_context46.next=8;return getTokenTotalSupply(UNI.addr);case 8:uniTotalSupplyStr=_context46.sent;_context46.t0=getPoolBalanceOfBonded;_context46.next=12;return getPoolLPAddress();case 12:_context46.t1=_context46.sent;_context46.t2=user;_context46.next=16;return(0,_context46.t0)(_context46.t1,_context46.t2);case 16:uniBondedSupplyStr=_context46.sent;token0Balance=toFloat(toTokenUnitsBN(reserve.reserve0,18));token1Balance=toFloat(toTokenUnitsBN(reserve.reserve1,18));ratio=toFloat(toTokenUnitsBN(uniBondedSupplyStr,18))/toFloat(toTokenUnitsBN(uniTotalSupplyStr,18));if(!(token0.toLowerCase()===DAI.addr.toLowerCase())){_context46.next=22;break;}return _context46.abrupt(\"return\",{dai:token0Balance*ratio,qsd:token1Balance*ratio});case 22:return _context46.abrupt(\"return\",{dai:token1Balance*ratio,qsd:token0Balance*ratio});case 23:case\"end\":return _context46.stop();}}},_callee46);}));return function getUserLPBonded(_x72){return _ref46.apply(this,arguments);};}();export var getUserLPStaged=/*#__PURE__*/function(){var _ref47=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee47(user){var _yield$Promise$all13,_yield$Promise$all14,reserve,token0,uniTotalSupplyStr,uniBondedSupplyStr,token0Balance,token1Balance,ratio;return _regeneratorRuntime.wrap(function _callee47$(_context47){while(1){switch(_context47.prev=_context47.next){case 0:_context47.next=2;return Promise.all([getReserves(),getToken0()]);case 2:_yield$Promise$all13=_context47.sent;_yield$Promise$all14=_slicedToArray(_yield$Promise$all13,2);reserve=_yield$Promise$all14[0];token0=_yield$Promise$all14[1];_context47.next=8;return getTokenTotalSupply(UNI.addr);case 8:uniTotalSupplyStr=_context47.sent;_context47.t0=getPoolBalanceOfStaged;_context47.next=12;return getPoolLPAddress();case 12:_context47.t1=_context47.sent;_context47.t2=user;_context47.next=16;return(0,_context47.t0)(_context47.t1,_context47.t2);case 16:uniBondedSupplyStr=_context47.sent;token0Balance=toFloat(toTokenUnitsBN(reserve.reserve0,18));token1Balance=toFloat(toTokenUnitsBN(reserve.reserve1,18));ratio=toFloat(toTokenUnitsBN(uniBondedSupplyStr,18))/toFloat(toTokenUnitsBN(uniTotalSupplyStr,18));if(!(token0.toLowerCase()===DAI.addr.toLowerCase())){_context47.next=22;break;}return _context47.abrupt(\"return\",{dai:token0Balance*ratio,qsd:token1Balance*ratio});case 22:return _context47.abrupt(\"return\",{dai:token1Balance*ratio,qsd:token0Balance*ratio});case 23:case\"end\":return _context47.stop();}}},_callee47);}));return function getUserLPStaged(_x73){return _ref47.apply(this,arguments);};}();export var getLPStagedLiquidity=/*#__PURE__*/function(){var _ref48=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee48(){var _yield$Promise$all15,_yield$Promise$all16,reserve,token0,uniTotalSupplyStr,uniBondedSupplyStr,token0Balance,token1Balance,ratio;return _regeneratorRuntime.wrap(function _callee48$(_context48){while(1){switch(_context48.prev=_context48.next){case 0:_context48.next=2;return Promise.all([getReserves(),getToken0()]);case 2:_yield$Promise$all15=_context48.sent;_yield$Promise$all16=_slicedToArray(_yield$Promise$all15,2);reserve=_yield$Promise$all16[0];token0=_yield$Promise$all16[1];_context48.next=8;return getTokenTotalSupply(UNI.addr);case 8:uniTotalSupplyStr=_context48.sent;_context48.t0=getPoolTotalStaged;_context48.next=12;return getPoolLPAddress();case 12:_context48.t1=_context48.sent;_context48.next=15;return(0,_context48.t0)(_context48.t1);case 15:uniBondedSupplyStr=_context48.sent;token0Balance=toFloat(toTokenUnitsBN(reserve.reserve0,18));token1Balance=toFloat(toTokenUnitsBN(reserve.reserve1,18));ratio=toFloat(toTokenUnitsBN(uniBondedSupplyStr,18))/toFloat(toTokenUnitsBN(uniTotalSupplyStr,18));if(!(token0.toLowerCase()===DAI.addr.toLowerCase())){_context48.next=21;break;}return _context48.abrupt(\"return\",{dai:token0Balance*ratio,qsd:token1Balance*ratio});case 21:return _context48.abrupt(\"return\",{dai:token1Balance*ratio,qsd:token0Balance*ratio});case 22:case\"end\":return _context48.stop();}}},_callee48);}));return function getLPStagedLiquidity(){return _ref48.apply(this,arguments);};}();export var getLPBondedLiquidity=/*#__PURE__*/function(){var _ref49=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee49(){var _yield$Promise$all17,_yield$Promise$all18,reserve,token0,uniTotalSupplyStr,uniBondedSupplyStr,token0Balance,token1Balance,ratio;return _regeneratorRuntime.wrap(function _callee49$(_context49){while(1){switch(_context49.prev=_context49.next){case 0:_context49.next=2;return Promise.all([getReserves(),getToken0()]);case 2:_yield$Promise$all17=_context49.sent;_yield$Promise$all18=_slicedToArray(_yield$Promise$all17,2);reserve=_yield$Promise$all18[0];token0=_yield$Promise$all18[1];_context49.next=8;return getTokenTotalSupply(UNI.addr);case 8:uniTotalSupplyStr=_context49.sent;_context49.t0=getPoolTotalBonded;_context49.next=12;return getPoolLPAddress();case 12:_context49.t1=_context49.sent;_context49.next=15;return(0,_context49.t0)(_context49.t1);case 15:uniBondedSupplyStr=_context49.sent;token0Balance=toFloat(toTokenUnitsBN(reserve.reserve0,18));token1Balance=toFloat(toTokenUnitsBN(reserve.reserve1,18));ratio=toFloat(toTokenUnitsBN(uniBondedSupplyStr,18))/toFloat(toTokenUnitsBN(uniTotalSupplyStr,18));if(!(token0.toLowerCase()===DAI.addr.toLowerCase())){_context49.next=21;break;}return _context49.abrupt(\"return\",{dai:token0Balance*ratio,qsd:token1Balance*ratio});case 21:return _context49.abrupt(\"return\",{dai:token1Balance*ratio,qsd:token0Balance*ratio});case 22:case\"end\":return _context49.stop();}}},_callee49);}));return function getLPBondedLiquidity(){return _ref49.apply(this,arguments);};}();export var getToken0=/*#__PURE__*/function(){var _ref50=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee50(){var exchange;return _regeneratorRuntime.wrap(function _callee50$(_context50){while(1){switch(_context50.prev=_context50.next){case 0:exchange=new web3.eth.Contract(uniswapPairAbi,UNI.addr);return _context50.abrupt(\"return\",exchange.methods.token0().call());case 2:case\"end\":return _context50.stop();}}},_callee50);}));return function getToken0(){return _ref50.apply(this,arguments);};}();// Pool\nexport var getPoolStatusOf=/*#__PURE__*/function(){var _ref51=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee51(pool,account){var poolContract;return _regeneratorRuntime.wrap(function _callee51$(_context51){while(1){switch(_context51.prev=_context51.next){case 0:poolContract=new web3.eth.Contract(poolAbi,pool);return _context51.abrupt(\"return\",poolContract.methods.statusOf(account).call());case 2:case\"end\":return _context51.stop();}}},_callee51);}));return function getPoolStatusOf(_x74,_x75){return _ref51.apply(this,arguments);};}();/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getPoolBalanceOfBonded=/*#__PURE__*/function(){var _ref52=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee52(pool,account){var poolContract;return _regeneratorRuntime.wrap(function _callee52$(_context52){while(1){switch(_context52.prev=_context52.next){case 0:if(!(account==='')){_context52.next=2;break;}return _context52.abrupt(\"return\",'0');case 2:poolContract=new web3.eth.Contract(poolAbi,pool);return _context52.abrupt(\"return\",poolContract.methods.balanceOfBonded(account).call());case 4:case\"end\":return _context52.stop();}}},_callee52);}));return function getPoolBalanceOfBonded(_x76,_x77){return _ref52.apply(this,arguments);};}();/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getPoolBalanceOfStaged=/*#__PURE__*/function(){var _ref53=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee53(pool,account){var poolContract;return _regeneratorRuntime.wrap(function _callee53$(_context53){while(1){switch(_context53.prev=_context53.next){case 0:poolContract=new web3.eth.Contract(poolAbi,pool);return _context53.abrupt(\"return\",poolContract.methods.balanceOfStaged(account).call());case 2:case\"end\":return _context53.stop();}}},_callee53);}));return function getPoolBalanceOfStaged(_x78,_x79){return _ref53.apply(this,arguments);};}();/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getPoolBalanceOfRewarded=/*#__PURE__*/function(){var _ref54=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee54(pool,account){var poolContract;return _regeneratorRuntime.wrap(function _callee54$(_context54){while(1){switch(_context54.prev=_context54.next){case 0:if(!(account==='')){_context54.next=2;break;}return _context54.abrupt(\"return\",'0');case 2:poolContract=new web3.eth.Contract(poolAbi,pool);return _context54.abrupt(\"return\",poolContract.methods.balanceOfRewarded(account).call());case 4:case\"end\":return _context54.stop();}}},_callee54);}));return function getPoolBalanceOfRewarded(_x80,_x81){return _ref54.apply(this,arguments);};}();/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getPoolBalanceOfClaimable=/*#__PURE__*/function(){var _ref55=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee55(pool,account){var poolContract;return _regeneratorRuntime.wrap(function _callee55$(_context55){while(1){switch(_context55.prev=_context55.next){case 0:poolContract=new web3.eth.Contract(poolAbi,pool);return _context55.abrupt(\"return\",poolContract.methods.balanceOfClaimable(account).call());case 2:case\"end\":return _context55.stop();}}},_callee55);}));return function getPoolBalanceOfClaimable(_x82,_x83){return _ref55.apply(this,arguments);};}();/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getPoolTotalBonded=/*#__PURE__*/function(){var _ref56=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee56(pool){var poolContract;return _regeneratorRuntime.wrap(function _callee56$(_context56){while(1){switch(_context56.prev=_context56.next){case 0:poolContract=new web3.eth.Contract(poolAbi,pool);return _context56.abrupt(\"return\",poolContract.methods.totalBonded().call());case 2:case\"end\":return _context56.stop();}}},_callee56);}));return function getPoolTotalBonded(_x84){return _ref56.apply(this,arguments);};}();export var getPoolTotalStaged=/*#__PURE__*/function(){var _ref57=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee57(pool){var poolContract;return _regeneratorRuntime.wrap(function _callee57$(_context57){while(1){switch(_context57.prev=_context57.next){case 0:poolContract=new web3.eth.Contract(poolAbi,pool);return _context57.abrupt(\"return\",poolContract.methods.totalStaged().call());case 2:case\"end\":return _context57.stop();}}},_callee57);}));return function getPoolTotalStaged(_x85){return _ref57.apply(this,arguments);};}();/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getPoolTotalRewarded1=/*#__PURE__*/function(){var _ref58=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee58(pool){var poolContract;return _regeneratorRuntime.wrap(function _callee58$(_context58){while(1){switch(_context58.prev=_context58.next){case 0:poolContract=new web3.eth.Contract(poolBondingAbi,pool);return _context58.abrupt(\"return\",poolContract.methods.totalRewarded1().call());case 2:case\"end\":return _context58.stop();}}},_callee58);}));return function getPoolTotalRewarded1(_x86){return _ref58.apply(this,arguments);};}();/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getPoolTotalRewarded2=/*#__PURE__*/function(){var _ref59=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee59(pool){var poolContract;return _regeneratorRuntime.wrap(function _callee59$(_context59){while(1){switch(_context59.prev=_context59.next){case 0:poolContract=new web3.eth.Contract(poolBondingAbi,pool);return _context59.abrupt(\"return\",poolContract.methods.totalRewarded2().call());case 2:case\"end\":return _context59.stop();}}},_callee59);}));return function getPoolTotalRewarded2(_x87){return _ref59.apply(this,arguments);};}();/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getPoolTotalClaimable1=/*#__PURE__*/function(){var _ref60=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee60(pool){var poolContract;return _regeneratorRuntime.wrap(function _callee60$(_context60){while(1){switch(_context60.prev=_context60.next){case 0:poolContract=new web3.eth.Contract(poolBondingAbi,pool);return _context60.abrupt(\"return\",poolContract.methods.totalClaimable1().call());case 2:case\"end\":return _context60.stop();}}},_callee60);}));return function getPoolTotalClaimable1(_x88){return _ref60.apply(this,arguments);};}();/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getPoolTotalClaimable2=/*#__PURE__*/function(){var _ref61=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee61(pool){var poolContract;return _regeneratorRuntime.wrap(function _callee61$(_context61){while(1){switch(_context61.prev=_context61.next){case 0:poolContract=new web3.eth.Contract(poolBondingAbi,pool);return _context61.abrupt(\"return\",poolContract.methods.totalClaimable2().call());case 2:case\"end\":return _context61.stop();}}},_callee61);}));return function getPoolTotalClaimable2(_x89){return _ref61.apply(this,arguments);};}();/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getPoolBalanceOfRewarded1=/*#__PURE__*/function(){var _ref62=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee62(pool,account){var poolContract;return _regeneratorRuntime.wrap(function _callee62$(_context62){while(1){switch(_context62.prev=_context62.next){case 0:poolContract=new web3.eth.Contract(poolBondingAbi,pool);return _context62.abrupt(\"return\",poolContract.methods.balanceOfRewarded1(account).call());case 2:case\"end\":return _context62.stop();}}},_callee62);}));return function getPoolBalanceOfRewarded1(_x90,_x91){return _ref62.apply(this,arguments);};}();/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getPoolBalanceOfRewarded2=/*#__PURE__*/function(){var _ref63=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee63(pool,account){var poolContract;return _regeneratorRuntime.wrap(function _callee63$(_context63){while(1){switch(_context63.prev=_context63.next){case 0:poolContract=new web3.eth.Contract(poolBondingAbi,pool);return _context63.abrupt(\"return\",poolContract.methods.balanceOfRewarded2(account).call());case 2:case\"end\":return _context63.stop();}}},_callee63);}));return function getPoolBalanceOfRewarded2(_x92,_x93){return _ref63.apply(this,arguments);};}();/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getPoolBalanceOfClaimable1=/*#__PURE__*/function(){var _ref64=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee64(pool,account){var poolContract;return _regeneratorRuntime.wrap(function _callee64$(_context64){while(1){switch(_context64.prev=_context64.next){case 0:poolContract=new web3.eth.Contract(poolBondingAbi,pool);return _context64.abrupt(\"return\",poolContract.methods.balanceOfClaimable1(account).call());case 2:case\"end\":return _context64.stop();}}},_callee64);}));return function getPoolBalanceOfClaimable1(_x94,_x95){return _ref64.apply(this,arguments);};}();/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getPoolBalanceOfClaimable2=/*#__PURE__*/function(){var _ref65=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee65(pool,account){var poolContract;return _regeneratorRuntime.wrap(function _callee65$(_context65){while(1){switch(_context65.prev=_context65.next){case 0:poolContract=new web3.eth.Contract(poolBondingAbi,pool);return _context65.abrupt(\"return\",poolContract.methods.balanceOfClaimable2(account).call());case 2:case\"end\":return _context65.stop();}}},_callee65);}));return function getPoolBalanceOfClaimable2(_x96,_x97){return _ref65.apply(this,arguments);};}();/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */export var getPoolFluidUntil=/*#__PURE__*/function(){var _ref66=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee66(pool,account){var poolContract,blockNumber,fromBlock,bondP,unbondP,_yield$Promise$all19,_yield$Promise$all20,bond,unbond,events,startEpoch;return _regeneratorRuntime.wrap(function _callee66$(_context66){while(1){switch(_context66.prev=_context66.next){case 0:poolContract=new web3.eth.Contract(poolAbi,pool);// no need to look back further than the pool lockup period\n_context66.next=3;return web3.eth.getBlockNumber();case 3:blockNumber=_context66.sent;fromBlock=blockNumber-(POOL_EXIT_LOCKUP_EPOCHS+1)*8640;bondP=poolContract.getPastEvents('Bond',{filter:{account:account},fromBlock:fromBlock});unbondP=poolContract.getPastEvents('Unbond',{filter:{account:account},fromBlock:fromBlock});_context66.next=9;return Promise.all([bondP,unbondP]);case 9:_yield$Promise$all19=_context66.sent;_yield$Promise$all20=_slicedToArray(_yield$Promise$all19,2);bond=_yield$Promise$all20[0];unbond=_yield$Promise$all20[1];events=bond.map(function(e){return e.returnValues;}).concat(unbond.map(function(e){return e.returnValues;}));startEpoch=events.reduce(function(epoch,event){if(epoch>event.start)return epoch;else return event.start;},0);// these contract events report the start epoch as one more than the active\n// epoch when the event is emitted, so we subtract 1 here to adjust\nreturn _context66.abrupt(\"return\",(parseInt(startEpoch,10)+POOL_EXIT_LOCKUP_EPOCHS-1).toString());case 16:case\"end\":return _context66.stop();}}},_callee66);}));return function getPoolFluidUntil(_x98,_x99){return _ref66.apply(this,arguments);};}();export var getDaoIsBootstrapping=/*#__PURE__*/function(){var _ref67=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee67(){var epoch,daoContract,isBootstrapping;return _regeneratorRuntime.wrap(function _callee67$(_context67){while(1){switch(_context67.prev=_context67.next){case 0:_context67.next=2;return getEpoch(QSDS.addr);case 2:epoch=_context67.sent;daoContract=new web3.eth.Contract(daoAbi,Dao);_context67.next=6;return daoContract.methods.bootstrappingAt(epoch).call();case 6:isBootstrapping=_context67.sent;return _context67.abrupt(\"return\",isBootstrapping);case 8:case\"end\":return _context67.stop();}}},_callee67);}));return function getDaoIsBootstrapping(){return _ref67.apply(this,arguments);};}();export var getExpansionAmount=/*#__PURE__*/function(){var _ref68=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee68(){var price,isBootstrapping,totalSupplyStr,totalSupply,MAX_SUPPLY_EXPANSION,delta,newSupply;return _regeneratorRuntime.wrap(function _callee68$(_context68){while(1){switch(_context68.prev=_context68.next){case 0:_context68.next=2;return getTWAPPrice();case 2:price=_context68.sent;_context68.next=5;return getDaoIsBootstrapping();case 5:isBootstrapping=_context68.sent;_context68.next=8;return getTokenTotalSupply(QSD.addr);case 8:totalSupplyStr=_context68.sent;totalSupply=toFloat(toTokenUnitsBN(totalSupplyStr,QSD.decimals));// 5.4% max supply\nMAX_SUPPLY_EXPANSION=0.054;if(!isBootstrapping){_context68.next=13;break;}return _context68.abrupt(\"return\",totalSupply*MAX_SUPPLY_EXPANSION);case 13:delta=Math.min(price-1,MAX_SUPPLY_EXPANSION);newSupply=totalSupply*delta;if(!(price<1)){_context68.next=17;break;}return _context68.abrupt(\"return\",0);case 17:return _context68.abrupt(\"return\",newSupply);case 18:case\"end\":return _context68.stop();}}},_callee68);}));return function getExpansionAmount(){return _ref68.apply(this,arguments);};}();export var getTWAPPrice=/*#__PURE__*/function(){var _ref69=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee69(){var daoContract,pairContract,oracleAddress,oracleContract,cumulativePriceStr,oracleTimestampStr,cumulativePrice,oracleTimestamp,token0,resp,blockTimestampLast,price0CumulativeLastStr,price1CumulativeLastStr,price0Cumulative,price1Cumulative,timeDelta,price0,price1;return _regeneratorRuntime.wrap(function _callee69$(_context69){while(1){switch(_context69.prev=_context69.next){case 0:daoContract=new web3.eth.Contract(daoAbi,Dao);pairContract=new web3.eth.Contract(uniswapPairAbi,UNI.addr);_context69.next=4;return daoContract.methods.oracle().call();case 4:oracleAddress=_context69.sent;oracleContract=new web3.eth.Contract(oracleAbi,oracleAddress);// Gets cumulative price\n// eslint-disable-next-line\n_context69.next=8;return oracleContract.methods._cumulative().call();case 8:cumulativePriceStr=_context69.sent;_context69.next=11;return oracleContract.methods._timestamp().call();case 11:oracleTimestampStr=_context69.sent;cumulativePrice=parseFloat(formatBN(toTokenUnitsBN(cumulativePriceStr,18),2).split(',').join(''));oracleTimestamp=parseInt(oracleTimestampStr,10);_context69.next=16;return pairContract.methods.token0().call();case 16:token0=_context69.sent;_context69.next=19;return pairContract.methods.getReserves().call();case 19:resp=_context69.sent;blockTimestampLast=parseInt(resp.blockTimestampLast,10);_context69.next=23;return pairContract.methods.price0CumulativeLast().call();case 23:price0CumulativeLastStr=_context69.sent;_context69.next=26;return pairContract.methods.price1CumulativeLast().call();case 26:price1CumulativeLastStr=_context69.sent;price0Cumulative=parseFloat(formatBN(toTokenUnitsBN(price0CumulativeLastStr,18),2).split(',').join(''));price1Cumulative=parseFloat(formatBN(toTokenUnitsBN(price1CumulativeLastStr,18),2).split(',').join(''));timeDelta=blockTimestampLast-oracleTimestamp;price0=(price0Cumulative-cumulativePrice)/timeDelta*1e18/Math.pow(2,112);price1=(price1Cumulative-cumulativePrice)/timeDelta*1e18/Math.pow(2,112);if(!(token0.toLowerCase()===QSD.addr.toLowerCase())){_context69.next=34;break;}return _context69.abrupt(\"return\",price0);case 34:return _context69.abrupt(\"return\",price1);case 35:case\"end\":return _context69.stop();}}},_callee69);}));return function getTWAPPrice(){return _ref69.apply(this,arguments);};}();","map":{"version":3,"sources":["/Users/J/crypto/dashboard/src/utils/infura.js"],"names":["Web3","BigNumber","Dao","UniswapV2Router02","QSD","UNI","DAI","QSDS","POOL_EXIT_LOCKUP_EPOCHS","formatBN","toTokenUnitsBN","toFloat","getPoolLPAddress","oracleAbi","require","dollarAbi","daoAbi","poolAbi","poolBondingAbi","uniswapRouterAbi","uniswapPairAbi","web3","window","ethereum","undefined","getTokenBalance","token","account","tokenContract","eth","Contract","methods","balanceOf","call","getTokenTotalSupply","totalSupply","getTokenAllowance","spender","allowance","getBalanceBonded","dao","daoContract","balanceOfBonded","getBalanceOfStaged","balanceOfStaged","getStatusOf","statusOf","getFluidUntil","fluidUntil","getLockedUntil","lockedUntil","getEpoch","epoch","getEpochTime","epochTime","getTotalDebt","totalDebt","getTotalClaimable","poolContract","totalClaimable","getTotalRewarded","totalRewarded","getTotalCoupons","totalCoupons","getTotalCouponsUnderlying","totalCouponUnderlying","getTotalBonded","totalBonded","getTotalStaged","totalStaged","getTotalBondedAt","totalBondedAt","getApproveFor","candidate","approveFor","getRejectFor","rejectFor","getStartFor","startFor","getPeriodFor","periodFor","getIsInitialized","isInitialized","getRecordedVote","recordedVote","getBalanceOfCoupons","balanceOfCoupons","getBatchBalanceOfCoupons","epochs","calls","map","Promise","all","getBalanceOfCouponsUnderlying","balanceOfCouponUnderlying","getBatchBalanceOfCouponsUnderlying","getOutstandingCoupons","outstandingCoupons","getCouponsExpiration","couponsExpiration","getBatchCouponsExpiration","getCouponPremium","amount","couponPremium","toFixed","getImplementation","implementation","getPoolBonding","poolBonding","getPoolLP","poolLP","getPoolGov","poolGov","getCouponEpochs","purchaseP","getPastEvents","filter","fromBlock","transferP","to","bought","given","events","e","returnValues","couponAmount","concat","couponEpochs","reduce","event","prev","get","set","coupons","plus","Map","values","sort","a","b","getAllProposals","payload","prop","blockNumber","getAllRegulations","increaseP","decreaseP","neutralP","increase","decrease","neutral","type","data","getCost","exchange","getAmountsIn","addr","inputAmount","_","getProceeds","getAmountsOut","outputAmount","getReserves","getInstantaneousQSDPrice","getToken0","reserve","token0","token0Balance","reserve0","token1Balance","reserve1","toLowerCase","multipliedBy","pow","dividedBy","getUniswapLiquidity","dai","qsd","getUserLPWallet","user","uniTotalSupplyStr","uniBondedSupplyStr","ratio","getUserLPBonded","getPoolBalanceOfBonded","getUserLPStaged","getPoolBalanceOfStaged","getLPStagedLiquidity","getPoolTotalStaged","getLPBondedLiquidity","getPoolTotalBonded","getPoolStatusOf","pool","getPoolBalanceOfRewarded","balanceOfRewarded","getPoolBalanceOfClaimable","balanceOfClaimable","getPoolTotalRewarded1","totalRewarded1","getPoolTotalRewarded2","totalRewarded2","getPoolTotalClaimable1","totalClaimable1","getPoolTotalClaimable2","totalClaimable2","getPoolBalanceOfRewarded1","balanceOfRewarded1","getPoolBalanceOfRewarded2","balanceOfRewarded2","getPoolBalanceOfClaimable1","balanceOfClaimable1","getPoolBalanceOfClaimable2","balanceOfClaimable2","getPoolFluidUntil","getBlockNumber","bondP","unbondP","bond","unbond","startEpoch","start","parseInt","toString","getDaoIsBootstrapping","bootstrappingAt","isBootstrapping","getExpansionAmount","getTWAPPrice","price","totalSupplyStr","decimals","MAX_SUPPLY_EXPANSION","delta","Math","min","newSupply","pairContract","oracle","oracleAddress","oracleContract","_cumulative","cumulativePriceStr","_timestamp","oracleTimestampStr","cumulativePrice","parseFloat","split","join","oracleTimestamp","resp","blockTimestampLast","price0CumulativeLast","price0CumulativeLastStr","price1CumulativeLast","price1CumulativeLastStr","price0Cumulative","price1Cumulative","timeDelta","price0","price1"],"mappings":"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","sourcesContent":["import Web3 from 'web3';\n\nimport BigNumber from 'bignumber.js';\nimport { Dao, UniswapV2Router02 } from '../constants/contracts';\nimport { QSD, UNI, DAI, QSDS } from '../constants/tokens';\nimport { POOL_EXIT_LOCKUP_EPOCHS } from '../constants/values';\nimport { formatBN, toTokenUnitsBN, toFloat } from './number';\nimport { getPoolLPAddress } from './pool';\n\nconst oracleAbi = require('../constants/abi/Oracle.json');\nconst dollarAbi = require('../constants/abi/Dollar.json');\nconst daoAbi = require('../constants/abi/Dao.json');\nconst poolAbi = require('../constants/abi/Pool.json');\nconst poolBondingAbi = require('../constants/abi/PoolBonding.json');\nconst uniswapRouterAbi = require('../constants/abi/UniswapV2Router02.json');\nconst uniswapPairAbi = require('../constants/abi/UniswapV2Pair.json');\n\nlet web3;\n// eslint-disable-next-line no-undef\nif (window.ethereum !== undefined) {\n  // eslint-disable-next-line no-undef\n  web3 = new Web3(ethereum);\n}\n\n/**\n *\n * @param {string} token address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getTokenBalance = async (token, account) => {\n  if (account === '') return '0';\n  const tokenContract = new web3.eth.Contract(dollarAbi, token);\n  return tokenContract.methods.balanceOf(account).call();\n};\n\nexport const getTokenTotalSupply = async (token) => {\n  const tokenContract = new web3.eth.Contract(dollarAbi, token);\n  return tokenContract.methods.totalSupply().call();\n};\n\n/**\n *\n * @param {string} token\n * @param {string} account\n * @param {string} spender\n * @return {Promise<string>}\n */\nexport const getTokenAllowance = async (token, account, spender) => {\n  const tokenContract = new web3.eth.Contract(dollarAbi, token);\n  return tokenContract.methods.allowance(account, spender).call();\n};\n\n// QSD Protocol\n\n/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getBalanceBonded = async (dao, account) => {\n  if (account === '') return '0';\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.balanceOfBonded(account).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getBalanceOfStaged = async (dao, account) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.balanceOfStaged(account).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getStatusOf = async (dao, account) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.statusOf(account).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getFluidUntil = async (dao, account) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.fluidUntil(account).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getLockedUntil = async (dao, account) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.lockedUntil(account).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */\nexport const getEpoch = async (dao) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.epoch().call();\n};\n\n/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */\nexport const getEpochTime = async (dao) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.epochTime().call();\n};\n\n/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */\nexport const getTotalDebt = async (dao) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.totalDebt().call();\n};\n\n/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */\nexport const getTotalClaimable = async (dao) => {\n  const poolContract = new web3.eth.Contract(poolAbi, dao);\n  return poolContract.methods.totalClaimable().call();\n};\n\n/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */\nexport const getTotalRewarded = async (dao) => {\n  const poolContract = new web3.eth.Contract(poolAbi, dao);\n  return poolContract.methods.totalRewarded().call();\n};\n\n/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */\nexport const getTotalCoupons = async (dao) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.totalCoupons().call();\n};\n\n/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */\nexport const getTotalCouponsUnderlying = async (dao) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.totalCouponUnderlying().call();\n};\n\n/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */\nexport const getTotalBonded = async (dao) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.totalBonded().call();\n};\n\n/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */\nexport const getTotalStaged = async (dao) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.totalStaged().call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {number} epoch number\n * @return {Promise<string>}\n */\nexport const getTotalBondedAt = async (dao, epoch) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.totalBondedAt(epoch).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string} candidate address\n * @return {Promise<string>}\n */\nexport const getApproveFor = async (dao, candidate) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.approveFor(candidate).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string} candidate address\n * @return {Promise<string>}\n */\nexport const getRejectFor = async (dao, candidate) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.rejectFor(candidate).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string} candidate address\n * @return {Promise<string>}\n */\nexport const getStartFor = async (dao, candidate) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.startFor(candidate).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string} candidate address\n * @return {Promise<string>}\n */\nexport const getPeriodFor = async (dao, candidate) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.periodFor(candidate).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string} candidate address\n * @return {Promise<boolean>}\n */\nexport const getIsInitialized = async (dao, candidate) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.isInitialized(candidate).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @param {string} candidate address\n * @return {Promise<string>}\n */\nexport const getRecordedVote = async (dao, account, candidate) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.recordedVote(account, candidate).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @param {number} epoch number\n * @return {Promise<string>}\n */\nexport const getBalanceOfCoupons = async (dao, account, epoch) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.balanceOfCoupons(account, epoch).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @param {number[]} epochs number[]\n * @return {Promise<string[]>}\n */\nexport const getBatchBalanceOfCoupons = async (dao, account, epochs) => {\n  const calls = epochs.map((epoch) => getBalanceOfCoupons(dao, account, epoch));\n  return Promise.all(calls);\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @param {number} epoch number\n * @return {Promise<string>}\n */\nexport const getBalanceOfCouponsUnderlying = async (dao, account, epoch) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.balanceOfCouponUnderlying(account, epoch).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string} account address\n * @param {number[]} epochs number[]\n * @return {Promise<string[]>}\n */\nexport const getBatchBalanceOfCouponsUnderlying = async (\n  dao,\n  account,\n  epochs\n) => {\n  const calls = epochs.map((epoch) =>\n    getBalanceOfCouponsUnderlying(dao, account, epoch)\n  );\n  return Promise.all(calls);\n};\n\n/**\n *\n * @param {string} dao address\n * @param {number} epoch address\n * @return {Promise<string>}\n */\nexport const getOutstandingCoupons = async (dao, epoch) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.outstandingCoupons(epoch).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {number} epoch number\n * @return {Promise<string>}\n */\nexport const getCouponsExpiration = async (dao, epoch) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.couponsExpiration(epoch).call();\n};\n\n/**\n *\n * @param {string} dao address\n * @param {number[]} epochs number[]\n * @return {Promise<string[]>}\n */\nexport const getBatchCouponsExpiration = async (dao, epochs) => {\n  const calls = epochs.map((epoch) => getCouponsExpiration(dao, epoch));\n  return Promise.all(calls);\n};\n\n/**\n *\n * @param {string} dao address\n * @param {string|BigNumber} amount uint256\n * @return {Promise<string>}\n */\nexport const getCouponPremium = async (dao, amount) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods\n    .couponPremium(new BigNumber(amount).toFixed())\n    .call();\n};\n\n/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */\nexport const getImplementation = async (dao) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.implementation().call();\n};\n\n/**\n *\n * @param {string} dao address\n * @return {Promise<string>}\n */\nexport const getPoolBonding = async (dao) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.poolBonding().call();\n};\n\nexport const getPoolLP = async (dao) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.poolLP().call();\n};\n\nexport const getPoolGov = async (dao) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  return daoContract.methods.poolGov().call();\n};\n\n/**\n *\n * @param {string} dao\n * @param {string} account\n * @return {Promise<any[]>}\n */\nexport const getCouponEpochs = async (dao, account) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  const purchaseP = daoContract.getPastEvents('CouponPurchase', {\n    filter: { account },\n    fromBlock: 0,\n  });\n  const transferP = daoContract.getPastEvents('CouponTransfer', {\n    filter: { to: account },\n    fromBlock: 0,\n  });\n  const [bought, given] = await Promise.all([purchaseP, transferP]);\n  const events = bought\n    .map((e) => ({\n      epoch: e.returnValues.epoch,\n      amount: e.returnValues.couponAmount,\n    }))\n    .concat(given.map((e) => ({ epoch: e.returnValues.epoch, amount: 0 })));\n\n  const couponEpochs = [\n    ...events\n      .reduce((map, event) => {\n        const { epoch, amount } = event;\n        const prev = map.get(epoch);\n\n        if (prev) {\n          map.set(epoch, {\n            epoch,\n            coupons: prev.coupons.plus(new BigNumber(amount)),\n          });\n        } else {\n          map.set(epoch, { epoch, coupons: new BigNumber(amount) });\n        }\n\n        return map;\n      }, new Map())\n      .values(),\n  ];\n\n  return couponEpochs.sort((a, b) => a - b);\n};\n\n/**\n *\n * @param {string} dao\n * @return {Promise<any[]>}\n */\nexport const getAllProposals = async (dao) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  const payload = (\n    await daoContract.getPastEvents('Proposal', {\n      fromBlock: 0,\n    })\n  ).map((event) => {\n    const prop = event.returnValues;\n    prop.blockNumber = event.blockNumber;\n    return prop;\n  });\n  return payload.sort((a, b) => b.blockNumber - a.blockNumber);\n};\n\n/**\n *\n * @param {string} dao\n * @return {Promise<any[]>}\n */\nexport const getAllRegulations = async (dao) => {\n  const daoContract = new web3.eth.Contract(daoAbi, dao);\n  const increaseP = daoContract.getPastEvents('SupplyIncrease', {\n    fromBlock: 0,\n  });\n  const decreaseP = daoContract.getPastEvents('SupplyDecrease', {\n    fromBlock: 0,\n  });\n  const neutralP = daoContract.getPastEvents('SupplyNeutral', { fromBlock: 0 });\n\n  const [increase, decrease, neutral] = await Promise.all([\n    increaseP,\n    decreaseP,\n    neutralP,\n  ]);\n\n  const events = increase\n    .map((e) => ({ type: 'INCREASE', data: e.returnValues }))\n    .concat(decrease.map((e) => ({ type: 'DECREASE', data: e.returnValues })))\n    .concat(neutral.map((e) => ({ type: 'NEUTRAL', data: e.returnValues })));\n\n  return events.sort((a, b) => b.data.epoch - a.data.epoch);\n};\n\n// Uniswap Protocol\n\nexport const getCost = async (amount) => {\n  const exchange = new web3.eth.Contract(uniswapRouterAbi, UniswapV2Router02);\n  // eslint-disable-next-line no-unused-vars\n  const [inputAmount, _] = await exchange.methods\n    .getAmountsIn(new BigNumber(amount).toFixed(), [DAI.addr, QSD.addr])\n    .call();\n  return inputAmount;\n};\n\nexport const getProceeds = async (amount) => {\n  const exchange = new web3.eth.Contract(uniswapRouterAbi, UniswapV2Router02);\n  // eslint-disable-next-line no-unused-vars\n  const [_, outputAmount] = await exchange.methods\n    .getAmountsOut(new BigNumber(amount).toFixed(), [QSD.addr, DAI.addr])\n    .call();\n  return outputAmount;\n};\n\nexport const getReserves = async () => {\n  const exchange = new web3.eth.Contract(uniswapPairAbi, UNI.addr);\n  return exchange.methods.getReserves().call();\n};\n\nexport const getInstantaneousQSDPrice = async () => {\n  const [reserve, token0] = await Promise.all([getReserves(), getToken0()]);\n  const token0Balance = new BigNumber(reserve.reserve0);\n  const token1Balance = new BigNumber(reserve.reserve1);\n  if (token0.toLowerCase() === DAI.addr.toLowerCase()) {\n    return token0Balance\n      .multipliedBy(new BigNumber(10).pow(18))\n      .dividedBy(token1Balance);\n  }\n  return token1Balance\n    .multipliedBy(new BigNumber(10).pow(18))\n    .dividedBy(token0Balance);\n};\n\nexport const getUniswapLiquidity = async () => {\n  const [reserve, token0] = await Promise.all([getReserves(), getToken0()]);\n  const token0Balance = new BigNumber(reserve.reserve0);\n  const token1Balance = new BigNumber(reserve.reserve1);\n  if (token0.toLowerCase() === DAI.addr.toLowerCase()) {\n    return {\n      dai: token0Balance,\n      qsd: token1Balance,\n    };\n  }\n  return {\n    dai: token1Balance,\n    qsd: token0Balance,\n  };\n};\n\nexport const getUserLPWallet = async (user) => {\n  const [reserve, token0] = await Promise.all([getReserves(), getToken0()]);\n  const uniTotalSupplyStr = await getTokenTotalSupply(UNI.addr);\n  const uniBondedSupplyStr = await getTokenBalance(UNI.addr, user);\n\n  const token0Balance = toFloat(toTokenUnitsBN(reserve.reserve0, 18));\n  const token1Balance = toFloat(toTokenUnitsBN(reserve.reserve1, 18));\n\n  const ratio =\n    toFloat(toTokenUnitsBN(uniBondedSupplyStr, 18)) /\n    toFloat(toTokenUnitsBN(uniTotalSupplyStr, 18));\n\n  if (token0.toLowerCase() === DAI.addr.toLowerCase()) {\n    return {\n      dai: token0Balance * ratio,\n      qsd: token1Balance * ratio,\n    };\n  }\n  return {\n    dai: token1Balance * ratio,\n    qsd: token0Balance * ratio,\n  };\n};\n\nexport const getUserLPBonded = async (user) => {\n  const [reserve, token0] = await Promise.all([getReserves(), getToken0()]);\n  const uniTotalSupplyStr = await getTokenTotalSupply(UNI.addr);\n  const uniBondedSupplyStr = await getPoolBalanceOfBonded(\n    await getPoolLPAddress(),\n    user\n  );\n\n  const token0Balance = toFloat(toTokenUnitsBN(reserve.reserve0, 18));\n  const token1Balance = toFloat(toTokenUnitsBN(reserve.reserve1, 18));\n\n  const ratio =\n    toFloat(toTokenUnitsBN(uniBondedSupplyStr, 18)) /\n    toFloat(toTokenUnitsBN(uniTotalSupplyStr, 18));\n\n  if (token0.toLowerCase() === DAI.addr.toLowerCase()) {\n    return {\n      dai: token0Balance * ratio,\n      qsd: token1Balance * ratio,\n    };\n  }\n  return {\n    dai: token1Balance * ratio,\n    qsd: token0Balance * ratio,\n  };\n};\n\nexport const getUserLPStaged = async (user) => {\n  const [reserve, token0] = await Promise.all([getReserves(), getToken0()]);\n  const uniTotalSupplyStr = await getTokenTotalSupply(UNI.addr);\n  const uniBondedSupplyStr = await getPoolBalanceOfStaged(\n    await getPoolLPAddress(),\n    user\n  );\n\n  const token0Balance = toFloat(toTokenUnitsBN(reserve.reserve0, 18));\n  const token1Balance = toFloat(toTokenUnitsBN(reserve.reserve1, 18));\n\n  const ratio =\n    toFloat(toTokenUnitsBN(uniBondedSupplyStr, 18)) /\n    toFloat(toTokenUnitsBN(uniTotalSupplyStr, 18));\n\n  if (token0.toLowerCase() === DAI.addr.toLowerCase()) {\n    return {\n      dai: token0Balance * ratio,\n      qsd: token1Balance * ratio,\n    };\n  }\n  return {\n    dai: token1Balance * ratio,\n    qsd: token0Balance * ratio,\n  };\n};\n\nexport const getLPStagedLiquidity = async () => {\n  const [reserve, token0] = await Promise.all([getReserves(), getToken0()]);\n  const uniTotalSupplyStr = await getTokenTotalSupply(UNI.addr);\n  const uniBondedSupplyStr = await getPoolTotalStaged(await getPoolLPAddress());\n\n  const token0Balance = toFloat(toTokenUnitsBN(reserve.reserve0, 18));\n  const token1Balance = toFloat(toTokenUnitsBN(reserve.reserve1, 18));\n\n  const ratio =\n    toFloat(toTokenUnitsBN(uniBondedSupplyStr, 18)) /\n    toFloat(toTokenUnitsBN(uniTotalSupplyStr, 18));\n\n  if (token0.toLowerCase() === DAI.addr.toLowerCase()) {\n    return {\n      dai: token0Balance * ratio,\n      qsd: token1Balance * ratio,\n    };\n  }\n  return {\n    dai: token1Balance * ratio,\n    qsd: token0Balance * ratio,\n  };\n};\n\nexport const getLPBondedLiquidity = async () => {\n  const [reserve, token0] = await Promise.all([getReserves(), getToken0()]);\n  const uniTotalSupplyStr = await getTokenTotalSupply(UNI.addr);\n  const uniBondedSupplyStr = await getPoolTotalBonded(await getPoolLPAddress());\n\n  const token0Balance = toFloat(toTokenUnitsBN(reserve.reserve0, 18));\n  const token1Balance = toFloat(toTokenUnitsBN(reserve.reserve1, 18));\n\n  const ratio =\n    toFloat(toTokenUnitsBN(uniBondedSupplyStr, 18)) /\n    toFloat(toTokenUnitsBN(uniTotalSupplyStr, 18));\n\n  if (token0.toLowerCase() === DAI.addr.toLowerCase()) {\n    return {\n      dai: token0Balance * ratio,\n      qsd: token1Balance * ratio,\n    };\n  }\n  return {\n    dai: token1Balance * ratio,\n    qsd: token0Balance * ratio,\n  };\n};\n\nexport const getToken0 = async () => {\n  const exchange = new web3.eth.Contract(uniswapPairAbi, UNI.addr);\n  return exchange.methods.token0().call();\n};\n\n// Pool\n\nexport const getPoolStatusOf = async (pool, account) => {\n  const poolContract = new web3.eth.Contract(poolAbi, pool);\n  return poolContract.methods.statusOf(account).call();\n};\n\n/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getPoolBalanceOfBonded = async (pool, account) => {\n  if (account === '') return '0';\n  const poolContract = new web3.eth.Contract(poolAbi, pool);\n  return poolContract.methods.balanceOfBonded(account).call();\n};\n\n/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getPoolBalanceOfStaged = async (pool, account) => {\n  const poolContract = new web3.eth.Contract(poolAbi, pool);\n  return poolContract.methods.balanceOfStaged(account).call();\n};\n\n/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getPoolBalanceOfRewarded = async (pool, account) => {\n  if (account === '') return '0';\n  const poolContract = new web3.eth.Contract(poolAbi, pool);\n  return poolContract.methods.balanceOfRewarded(account).call();\n};\n\n/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getPoolBalanceOfClaimable = async (pool, account) => {\n  const poolContract = new web3.eth.Contract(poolAbi, pool);\n  return poolContract.methods.balanceOfClaimable(account).call();\n};\n\n/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getPoolTotalBonded = async (pool) => {\n  const poolContract = new web3.eth.Contract(poolAbi, pool);\n  return poolContract.methods.totalBonded().call();\n};\n\nexport const getPoolTotalStaged = async (pool) => {\n  const poolContract = new web3.eth.Contract(poolAbi, pool);\n  return poolContract.methods.totalStaged().call();\n};\n\n/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getPoolTotalRewarded1 = async (pool) => {\n  const poolContract = new web3.eth.Contract(poolBondingAbi, pool);\n  return poolContract.methods.totalRewarded1().call();\n};\n\n/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getPoolTotalRewarded2 = async (pool) => {\n  const poolContract = new web3.eth.Contract(poolBondingAbi, pool);\n  return poolContract.methods.totalRewarded2().call();\n};\n\n/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getPoolTotalClaimable1 = async (pool) => {\n  const poolContract = new web3.eth.Contract(poolBondingAbi, pool);\n  return poolContract.methods.totalClaimable1().call();\n};\n\n/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getPoolTotalClaimable2 = async (pool) => {\n  const poolContract = new web3.eth.Contract(poolBondingAbi, pool);\n  return poolContract.methods.totalClaimable2().call();\n};\n\n/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getPoolBalanceOfRewarded1 = async (pool, account) => {\n  const poolContract = new web3.eth.Contract(poolBondingAbi, pool);\n  return poolContract.methods.balanceOfRewarded1(account).call();\n};\n\n/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getPoolBalanceOfRewarded2 = async (pool, account) => {\n  const poolContract = new web3.eth.Contract(poolBondingAbi, pool);\n  return poolContract.methods.balanceOfRewarded2(account).call();\n};\n\n/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getPoolBalanceOfClaimable1 = async (pool, account) => {\n  const poolContract = new web3.eth.Contract(poolBondingAbi, pool);\n  return poolContract.methods.balanceOfClaimable1(account).call();\n};\n\n/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getPoolBalanceOfClaimable2 = async (pool, account) => {\n  const poolContract = new web3.eth.Contract(poolBondingAbi, pool);\n  return poolContract.methods.balanceOfClaimable2(account).call();\n};\n\n/**\n *\n * @param {string} pool address\n * @param {string} account address\n * @return {Promise<string>}\n */\nexport const getPoolFluidUntil = async (pool, account) => {\n  const poolContract = new web3.eth.Contract(poolAbi, pool);\n\n  // no need to look back further than the pool lockup period\n  const blockNumber = await web3.eth.getBlockNumber();\n  const fromBlock = blockNumber - (POOL_EXIT_LOCKUP_EPOCHS + 1) * 8640;\n  const bondP = poolContract.getPastEvents('Bond', {\n    filter: { account: account },\n    fromBlock: fromBlock,\n  });\n  const unbondP = poolContract.getPastEvents('Unbond', {\n    filter: { account: account },\n    fromBlock: fromBlock,\n  });\n\n  const [bond, unbond] = await Promise.all([bondP, unbondP]);\n  const events = bond\n    .map((e) => e.returnValues)\n    .concat(unbond.map((e) => e.returnValues));\n\n  const startEpoch = events.reduce((epoch, event) => {\n    if (epoch > event.start) return epoch;\n    else return event.start;\n  }, 0);\n\n  // these contract events report the start epoch as one more than the active\n  // epoch when the event is emitted, so we subtract 1 here to adjust\n  return (parseInt(startEpoch, 10) + POOL_EXIT_LOCKUP_EPOCHS - 1).toString();\n};\n\nexport const getDaoIsBootstrapping = async () => {\n  const epoch = await getEpoch(QSDS.addr);\n  const daoContract = new web3.eth.Contract(daoAbi, Dao);\n  const isBootstrapping = await daoContract.methods\n    .bootstrappingAt(epoch)\n    .call();\n\n  return isBootstrapping;\n};\n\nexport const getExpansionAmount = async () => {\n  const price = await getTWAPPrice();\n  const isBootstrapping = await getDaoIsBootstrapping();\n\n  const totalSupplyStr = await getTokenTotalSupply(QSD.addr);\n  const totalSupply = toFloat(toTokenUnitsBN(totalSupplyStr, QSD.decimals));\n\n  // 5.4% max supply\n  const MAX_SUPPLY_EXPANSION = 0.054;\n\n  if (isBootstrapping) {\n    return totalSupply * MAX_SUPPLY_EXPANSION;\n  }\n\n  const delta = Math.min(price - 1, MAX_SUPPLY_EXPANSION);\n  const newSupply = totalSupply * delta;\n\n  if (price < 1) {\n    return 0;\n  }\n\n  return newSupply;\n};\n\nexport const getTWAPPrice = async () => {\n  const daoContract = new web3.eth.Contract(daoAbi, Dao);\n  const pairContract = new web3.eth.Contract(uniswapPairAbi, UNI.addr);\n\n  const oracleAddress = await daoContract.methods.oracle().call();\n  const oracleContract = new web3.eth.Contract(oracleAbi, oracleAddress);\n\n  // Gets cumulative price\n\n  // eslint-disable-next-line\n  const cumulativePriceStr = await oracleContract.methods._cumulative().call();\n  // eslint-disable-next-line\n  const oracleTimestampStr = await oracleContract.methods._timestamp().call();\n\n  const cumulativePrice = parseFloat(\n    formatBN(toTokenUnitsBN(cumulativePriceStr, 18), 2).split(',').join('')\n  );\n  const oracleTimestamp = parseInt(oracleTimestampStr, 10);\n\n  const token0 = await pairContract.methods.token0().call();\n\n  const resp = await pairContract.methods.getReserves().call();\n  const blockTimestampLast = parseInt(resp.blockTimestampLast, 10);\n  const price0CumulativeLastStr = await pairContract.methods\n    .price0CumulativeLast()\n    .call();\n  const price1CumulativeLastStr = await pairContract.methods\n    .price1CumulativeLast()\n    .call();\n\n  const price0Cumulative = parseFloat(\n    formatBN(toTokenUnitsBN(price0CumulativeLastStr, 18), 2).split(',').join('')\n  );\n  const price1Cumulative = parseFloat(\n    formatBN(toTokenUnitsBN(price1CumulativeLastStr, 18), 2).split(',').join('')\n  );\n\n  const timeDelta = blockTimestampLast - oracleTimestamp;\n\n  const price0 =\n    (((price0Cumulative - cumulativePrice) / timeDelta) * 1e18) / 2 ** 112;\n  const price1 =\n    (((price1Cumulative - cumulativePrice) / timeDelta) * 1e18) / 2 ** 112;\n\n  if (token0.toLowerCase() === QSD.addr.toLowerCase()) {\n    return price0;\n  }\n\n  return price1;\n};\n"]},"metadata":{},"sourceType":"module"}