{"ast":null,"code":"import _regeneratorRuntime from\"/Users/J/crypto/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/J/crypto/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/J/crypto/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Button}from'@aragon/ui';import React,{useEffect,useState}from'react';import{NavLink}from'react-router-dom';//Commented By RDN\n// import { Layout } from '@aragon/ui';\nimport{IconHeader,Row,Tile,TopBorderBox,BRow,BCol,BContainer}from'../common';import Regulation from'../Regulation';import{QSD,QSDS}from'../../constants/tokens';import{getDaoIsBootstrapping,getExpansionAmount,getInstantaneousQSDPrice,getLPBondedLiquidity,getPoolTotalBonded,getTokenTotalSupply,getTotalBonded,getUniswapLiquidity}from'../../utils/infura';import{formatBN,toFloat,toTokenUnitsBN}from'../../utils/number';import{epochformatted}from'../../utils/calculation';import BigNumber from'bignumber.js';import{getPoolBondingAddress}from'../../utils/pool';function HomePage(_ref){var user=_ref.user;var _useState=useState('0-00:00:00'),_useState2=_slicedToArray(_useState,2),epochTime=_useState2[0],setEpochTime=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),totalSupply=_useState4[0],setTotalSupply=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),qsdPrice=_useState6[0],setQSDPrice=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),qsdLiquidity=_useState8[0],setQSDLiquidity=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),daiLiquidity=_useState10[0],setDAILiquidity=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),daoBonded=_useState12[0],setDaoBonded=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),lpQsdLiquidity=_useState14[0],setLpQsdLiquidity=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),lpDaiLiquidity=_useState16[0],setLpDaiLiquidity=_useState16[1];var _useState17=useState(null),_useState18=_slicedToArray(_useState17,2),expansionAmount=_useState18[0],setExpansionAmount=_useState18[1];useEffect(function(){var isCancelled=false;function updateInfo(){return _updateInfo.apply(this,arguments);}function _updateInfo(){_updateInfo=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var poolBonding,_yield$Promise$all,_yield$Promise$all2,supply,tokenPrice,liquidity,liquidityLp,expansion,bootstrapping,daoBonded,bondingBonded;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getPoolBondingAddress();case 2:poolBonding=_context.sent;_context.next=5;return Promise.all([getTokenTotalSupply(QSD.addr),getInstantaneousQSDPrice(),getUniswapLiquidity(),getLPBondedLiquidity(),getExpansionAmount(),getDaoIsBootstrapping(),getTotalBonded(QSDS.addr),getPoolTotalBonded(poolBonding)]);case 5:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,8);supply=_yield$Promise$all2[0];tokenPrice=_yield$Promise$all2[1];liquidity=_yield$Promise$all2[2];liquidityLp=_yield$Promise$all2[3];expansion=_yield$Promise$all2[4];bootstrapping=_yield$Promise$all2[5];daoBonded=_yield$Promise$all2[6];bondingBonded=_yield$Promise$all2[7];setTotalSupply(toTokenUnitsBN(supply,18));setQSDPrice(toTokenUnitsBN(tokenPrice,18));setQSDLiquidity(toTokenUnitsBN(liquidity.qsd,18));setDAILiquidity(toTokenUnitsBN(liquidity.dai,18));setLpQsdLiquidity(liquidityLp.qsd);setLpDaiLiquidity(liquidityLp.dai);setExpansionAmount(expansion);if(bootstrapping){setDaoBonded(toTokenUnitsBN(daoBonded,18));}else{setDaoBonded(toTokenUnitsBN(bondingBonded,18));}case 23:case\"end\":return _context.stop();}}},_callee);}));return _updateInfo.apply(this,arguments);}function updateUserInfo(){return _updateUserInfo.apply(this,arguments);}function _updateUserInfo(){_updateUserInfo=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!isCancelled){setEpochTime(epochformatted());}case 1:case\"end\":return _context2.stop();}}},_callee2);}));return _updateUserInfo.apply(this,arguments);}updateInfo();updateUserInfo();var id=setInterval(updateUserInfo,1000);// eslint-disable-next-line consistent-return\nreturn function(){isCancelled=true;clearInterval(id);};},[user]);var daoWeeklyYield='...';//let daoHourlyYield = '...';\nvar daoDailyYield='...';var daoMonthlyYield='...';var lpWeeklyYield='...';//let lpHourlyYield = '...';\nvar lpDailyYield='...';var lpMonthlyYield='...';// Define number formatting\nvar options={minimumFractionDigits:0,maximumFractionDigits:2};var numberFormat=new Intl.NumberFormat('en-US',options);// Calculate LP APR (4 hrs)\nif(qsdPrice&&lpQsdLiquidity&&lpDaiLiquidity&&expansionAmount){var totalDAI=lpQsdLiquidity*toFloat(qsdPrice)+lpDaiLiquidity;var daiToAdd=expansionAmount/2*toFloat(qsdPrice);var lpYield=daiToAdd/totalDAI*100;//lpHourlyYield = numberFormat.format(lpYield / 4) + '%';\nlpDailyYield=numberFormat.format(lpYield*6)+'%';lpWeeklyYield=numberFormat.format(lpYield*6*7)+'%';lpMonthlyYield=numberFormat.format(lpYield*6*30)+'%';}// Calculate DAO APR (4 hrs)\nif(qsdPrice&&daoBonded&&expansionAmount){var totalQSD=toFloat(daoBonded);var qsdToAdd=expansionAmount/2;var daoYield=qsdToAdd/totalQSD*100;//daoHourlyYield = numberFormat.format(daoYield / 4) + '%';\ndaoDailyYield=numberFormat.format(daoYield*6)+'%';daoWeeklyYield=numberFormat.format(daoYield*6*7)+'%';daoMonthlyYield=numberFormat.format(daoYield*6*30)+'%';}var curEpoch=Number(epochTime.split('-')[0]);return/*#__PURE__*/React.createElement(BContainer,null,/*#__PURE__*/React.createElement(\"div\",{style:{margin:'60px 0'}},/*#__PURE__*/React.createElement(BRow,null,/*#__PURE__*/React.createElement(BCol,{lg:4,md:12,sm:12},/*#__PURE__*/React.createElement(Tile,{style:{height:'200px'},line1:\"Epoch\",line2:epochTime,line3:\"Advance -> \".concat(curEpoch+1)})),/*#__PURE__*/React.createElement(BCol,{lg:4,md:12,sm:12},/*#__PURE__*/React.createElement(Tile,{style:{height:'200px'},line1:\"Total Supply\",line2:totalSupply===null?'...':formatBN(totalSupply,2),line3:\"\".concat(Number(epochTime.split('-')[0])<108?'Bootstrapping phase':(qsdPrice===null||qsdPrice===void 0?void 0:qsdPrice.isGreaterThan(new BigNumber(10).pow(new BigNumber(18))))?'Above Peg':'Idle phase')})),/*#__PURE__*/React.createElement(BCol,{lg:4,md:12,sm:12},/*#__PURE__*/React.createElement(Tile,{style:{height:'200px'},line1:\"Market Cap\",line2:\"\".concat(totalSupply!==null&&qsdPrice!==null?'$'+formatBN(totalSupply.multipliedBy(qsdPrice),2):'...'),line3:\"\"}))),/*#__PURE__*/React.createElement(Section,null,/*#__PURE__*/React.createElement(IconHeader,{icon:/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-exchange-alt\"}),text:\"Trade\"}),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(TopBorderBox,{title:\"QSD Price\",body:qsdPrice?formatBN(qsdPrice,2)+' DAI':'...',action:/*#__PURE__*/React.createElement(Button,null,/*#__PURE__*/React.createElement(\"a\",{target:\"_blank\",rel:\"noopener noreferrer\",style:{textDecoration:'none'},href:\"https://app.uniswap.org/#/swap?outputCurrency=\".concat(QSD.addr)},\"Trade QSD\"))}),/*#__PURE__*/React.createElement(TopBorderBox,{title:\"QSD in LP pool\",body:qsdLiquidity?formatBN(qsdLiquidity,2)+' QSD':'...',action:/*#__PURE__*/React.createElement(Button,null,/*#__PURE__*/React.createElement(\"a\",{target:\"_blank\",rel:\"noopener noreferrer\",style:{textDecoration:'none'},href:\"https://info.uniswap.org/token/\".concat(QSD.addr)},\"Trade Info\"))}),/*#__PURE__*/React.createElement(TopBorderBox,{title:\"QSD Liquidity\",body:daiLiquidity?formatBN(daiLiquidity,2)+' DAI':'...',action:/*#__PURE__*/React.createElement(Button,null,/*#__PURE__*/React.createElement(\"a\",{target:\"_blank\",rel:\"noopener noreferrer\",style:{textDecoration:'none'},href:\"https://app.uniswap.org/#/add/\".concat(QSD.addr,\"/0x6b175474e89094c44da98b954eedeac495271d0f\")},\"Add Liquidity\"))}))),/*#__PURE__*/React.createElement(Section,null,/*#__PURE__*/React.createElement(IconHeader,{icon:/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-chart-line\"}),text:\"Invest\"}),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(TopBorderBox,{title:\"Bonded QSD APR\",body:/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,\"QSD Daily: \",daoDailyYield,\" \"),/*#__PURE__*/React.createElement(\"div\",null,\"QSD Weekly: \",daoWeeklyYield,\" \"),/*#__PURE__*/React.createElement(\"div\",null,\"QSD Monthly: \",daoMonthlyYield,\" \")),action:/*#__PURE__*/React.createElement(NavLink,Object.assign({component:Button,to:curEpoch<72?'/bootstrapping':'/qsd'},{external:false}),\"Add QSD\")}),/*#__PURE__*/React.createElement(TopBorderBox,{title:\"Bonded LP APR\",body:/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,\"LP Daily: \",lpDailyYield,\" \"),/*#__PURE__*/React.createElement(\"div\",null,\"LP Weekly: \",lpWeeklyYield,\" \"),/*#__PURE__*/React.createElement(\"div\",null,\"LP Monthly: \",lpMonthlyYield,\" \")),action:/*#__PURE__*/React.createElement(NavLink,Object.assign({component:Button,to:\"/lp\"},{external:false}),\"Add LP\")}))),/*#__PURE__*/React.createElement(Section,null,/*#__PURE__*/React.createElement(Regulation,{user:user,hideHistory:true}),/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:'center',marginTop:22}},/*#__PURE__*/React.createElement(NavLink,Object.assign({component:Button,to:\"/regulation\"},{external:false}),\"View more\")))));}function Section(props){return/*#__PURE__*/React.createElement(\"div\",Object.assign({style:{marginTop:80}},props));}export default HomePage;","map":{"version":3,"sources":["/Users/J/crypto/dashboard/src/components/HomePage/index.tsx"],"names":["Button","React","useEffect","useState","NavLink","IconHeader","Row","Tile","TopBorderBox","BRow","BCol","BContainer","Regulation","QSD","QSDS","getDaoIsBootstrapping","getExpansionAmount","getInstantaneousQSDPrice","getLPBondedLiquidity","getPoolTotalBonded","getTokenTotalSupply","getTotalBonded","getUniswapLiquidity","formatBN","toFloat","toTokenUnitsBN","epochformatted","BigNumber","getPoolBondingAddress","HomePage","user","epochTime","setEpochTime","totalSupply","setTotalSupply","qsdPrice","setQSDPrice","qsdLiquidity","setQSDLiquidity","daiLiquidity","setDAILiquidity","daoBonded","setDaoBonded","lpQsdLiquidity","setLpQsdLiquidity","lpDaiLiquidity","setLpDaiLiquidity","expansionAmount","setExpansionAmount","isCancelled","updateInfo","poolBonding","Promise","all","addr","supply","tokenPrice","liquidity","liquidityLp","expansion","bootstrapping","bondingBonded","qsd","dai","updateUserInfo","id","setInterval","clearInterval","daoWeeklyYield","daoDailyYield","daoMonthlyYield","lpWeeklyYield","lpDailyYield","lpMonthlyYield","options","minimumFractionDigits","maximumFractionDigits","numberFormat","Intl","NumberFormat","totalDAI","daiToAdd","lpYield","format","totalQSD","qsdToAdd","daoYield","curEpoch","Number","split","margin","height","isGreaterThan","pow","multipliedBy","textDecoration","external","textAlign","marginTop","Section","props"],"mappings":"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","sourcesContent":["import { Button } from '@aragon/ui';\nimport React, { ComponentProps, useEffect, useState } from 'react';\nimport { NavLink } from 'react-router-dom';\n//Commented By RDN\n// import { Layout } from '@aragon/ui';\nimport { IconHeader, Row, Tile, TopBorderBox , BRow, BCol , BContainer } from '../common';\nimport Regulation from '../Regulation';\nimport { QSD, QSDS } from '../../constants/tokens';\nimport {\n  getDaoIsBootstrapping,\n  getExpansionAmount,\n  getInstantaneousQSDPrice,\n  getLPBondedLiquidity,\n  getPoolTotalBonded,\n  getTokenTotalSupply,\n  getTotalBonded,\n  getUniswapLiquidity,\n} from '../../utils/infura';\nimport { formatBN, toFloat, toTokenUnitsBN } from '../../utils/number';\nimport { epochformatted } from '../../utils/calculation';\nimport BigNumber from 'bignumber.js';\nimport { getPoolBondingAddress } from '../../utils/pool';\n\ntype HomePageProps = {\n  user: string;\n};\n\nfunction HomePage({ user }: HomePageProps) {\n  const [epochTime, setEpochTime] = useState('0-00:00:00');\n  const [totalSupply, setTotalSupply] = useState<BigNumber | null>(null);\n  const [qsdPrice, setQSDPrice] = useState<BigNumber | null>(null);\n  const [qsdLiquidity, setQSDLiquidity] = useState<BigNumber | null>(null);\n  const [daiLiquidity, setDAILiquidity] = useState<BigNumber | null>(null);\n\n  const [daoBonded, setDaoBonded] = useState<BigNumber | null>(null);\n  const [lpQsdLiquidity, setLpQsdLiquidity] = useState<number | null>(null);\n  const [lpDaiLiquidity, setLpDaiLiquidity] = useState<number | null>(null);\n  const [expansionAmount, setExpansionAmount] = useState<number | null>(null);\n\n  useEffect(() => {\n    let isCancelled = false;\n\n    async function updateInfo() {\n      const poolBonding = await getPoolBondingAddress();\n\n      const [\n        supply,\n        tokenPrice,\n        liquidity,\n        liquidityLp,\n        expansion,\n        bootstrapping,\n        daoBonded,\n        bondingBonded,\n      ] = await Promise.all([\n        getTokenTotalSupply(QSD.addr),\n        getInstantaneousQSDPrice(),\n        getUniswapLiquidity(),\n        getLPBondedLiquidity(),\n        getExpansionAmount(),\n        getDaoIsBootstrapping(),\n        getTotalBonded(QSDS.addr),\n        getPoolTotalBonded(poolBonding),\n      ]);\n\n      setTotalSupply(toTokenUnitsBN(supply, 18));\n      setQSDPrice(toTokenUnitsBN(tokenPrice, 18));\n      setQSDLiquidity(toTokenUnitsBN(liquidity.qsd, 18));\n      setDAILiquidity(toTokenUnitsBN(liquidity.dai, 18));\n      setLpQsdLiquidity(liquidityLp.qsd);\n      setLpDaiLiquidity(liquidityLp.dai);\n      setExpansionAmount(expansion);\n\n      if (bootstrapping) {\n        setDaoBonded(toTokenUnitsBN(daoBonded, 18));\n      } else {\n        setDaoBonded(toTokenUnitsBN(bondingBonded, 18));\n      }\n    }\n\n    async function updateUserInfo() {\n      if (!isCancelled) {\n        setEpochTime(epochformatted());\n      }\n    }\n\n    updateInfo();\n    updateUserInfo();\n\n    const id = setInterval(updateUserInfo, 1000);\n\n    // eslint-disable-next-line consistent-return\n    return () => {\n      isCancelled = true;\n      clearInterval(id);\n    };\n  }, [user]);\n\n  let daoWeeklyYield = '...';\n  //let daoHourlyYield = '...';\n  let daoDailyYield = '...';\n  let daoMonthlyYield = '...';\n\n  let lpWeeklyYield = '...';\n  //let lpHourlyYield = '...';\n  let lpDailyYield = '...';\n  let lpMonthlyYield = '...';\n\n  // Define number formatting\n  var options = { minimumFractionDigits: 0,\n                maximumFractionDigits: 2 };\n  var numberFormat = new Intl.NumberFormat('en-US', options);\n\n  // Calculate LP APR (4 hrs)\n  if (qsdPrice && lpQsdLiquidity && lpDaiLiquidity && expansionAmount) {\n    const totalDAI = lpQsdLiquidity * toFloat(qsdPrice) + lpDaiLiquidity;\n    const daiToAdd = (expansionAmount / 2) * toFloat(qsdPrice);\n\n    const lpYield = (daiToAdd / totalDAI) * 100;\n\n    //lpHourlyYield = numberFormat.format(lpYield / 4) + '%';\n    lpDailyYield = numberFormat.format(lpYield * 6) + '%';\n    lpWeeklyYield = numberFormat.format(lpYield * 6 * 7) + '%';\n    lpMonthlyYield = numberFormat.format(lpYield * 6 * 30) +'%';\n  }\n\n  // Calculate DAO APR (4 hrs)\n  if (qsdPrice && daoBonded && expansionAmount) {\n    const totalQSD = toFloat(daoBonded);\n    const qsdToAdd = expansionAmount / 2;\n\n    const daoYield = (qsdToAdd / totalQSD) * 100;\n\n    //daoHourlyYield = numberFormat.format(daoYield / 4) + '%';\n    daoDailyYield = numberFormat.format(daoYield * 6) + '%';\n    daoWeeklyYield = numberFormat.format(daoYield * 6 * 7) + '%';\n    daoMonthlyYield = numberFormat.format(daoYield * 6 * 30) + '%';\n  }\n\n  const curEpoch = Number(epochTime.split('-')[0]);\n\n  return (\n    <BContainer>\n      {/*Commented By RDN*/}\n    {/* <Layout> */}\n      <div style={{ margin: '60px 0' }}>\n        \n        <BRow >\n        <BCol  lg={4}  md={12} sm={12}  >\n        <Tile\n            style={{height : '200px'}}\n            line1='Epoch'\n            line2={epochTime}\n            line3={`Advance -> ${curEpoch + 1}`}\n          />\n        </BCol>\n         <BCol   lg={4}  md={12} sm={12}>\n         <Tile\n            style={{height : '200px'}}\n            line1='Total Supply'\n            line2={totalSupply === null ? '...' : formatBN(totalSupply, 2)}\n            line3={`${\n              Number(epochTime.split('-')[0]) < 108\n                ? 'Bootstrapping phase'\n                : qsdPrice?.isGreaterThan(\n                    new BigNumber(10).pow(new BigNumber(18))\n                  )\n                ? 'Above Peg'\n                : 'Idle phase'\n            }`}\n          />\n         </BCol>\n         <BCol   lg={4}  md={12} sm={12}>\n         <Tile\n            style={{height : '200px'}}\n            line1='Market Cap'\n            line2={`${\n              totalSupply !== null && qsdPrice !== null\n                ? '$' + formatBN(totalSupply.multipliedBy(qsdPrice), 2)\n                : '...'\n            }`}\n            line3=''\n          />\n         </BCol>\n          \n        </BRow>\n        {/* </BContainer> */}\n\n        <Section>\n          <IconHeader\n            icon={<i className='fas fa-exchange-alt' />}\n            text='Trade'\n          />\n          <Row>\n            <TopBorderBox\n              title='QSD Price'\n              body={qsdPrice ? formatBN(qsdPrice, 2) + ' DAI' : '...'}\n              action={\n                <Button>\n                  <a\n                    target='_blank'\n                    rel=\"noopener noreferrer\" \n                    style={{ textDecoration: 'none' }}\n                    href={`https://app.uniswap.org/#/swap?outputCurrency=${QSD.addr}`}\n                  >\n                    Trade QSD\n                  </a>\n                </Button>\n              }\n            />\n            <TopBorderBox\n              title='QSD in LP pool'\n              body={qsdLiquidity ? formatBN(qsdLiquidity, 2) + ' QSD' : '...'}\n              action={\n                <Button>\n                  <a\n                    target='_blank'\n                    rel=\"noopener noreferrer\" \n                    style={{ textDecoration: 'none' }}\n                    href={`https://info.uniswap.org/token/${QSD.addr}`}\n                  >\n                    Trade Info\n                  </a>\n                </Button>\n              }\n            />\n            <TopBorderBox\n              title='QSD Liquidity'\n              body={daiLiquidity ? formatBN(daiLiquidity, 2) + ' DAI' : '...'}\n              action={\n                <Button>\n                  <a\n                    target='_blank'\n                    rel=\"noopener noreferrer\" \n                    style={{ textDecoration: 'none' }}\n                    href={`https://app.uniswap.org/#/add/${QSD.addr}/0x6b175474e89094c44da98b954eedeac495271d0f`}\n                  >\n                    Add Liquidity\n                  </a>\n                </Button>\n              }\n            />\n          </Row>\n        </Section>\n\n        <Section>\n          <IconHeader\n            icon={<i className='fas fa-chart-line' />}\n            text='Invest'\n          />\n          <Row>\n            <TopBorderBox\n              title='Bonded QSD APR'\n              body={\n                <>\n                  <div>QSD Daily: {daoDailyYield} </div>\n                  <div>QSD Weekly: {daoWeeklyYield} </div>\n                  <div>QSD Monthly: {daoMonthlyYield} </div>\n                </>\n              }\n              action={\n                <NavLink\n                  component={Button}\n                  to={curEpoch < 72 ? '/bootstrapping' : '/qsd'}\n                  {...{ external: false }}\n                >\n                  Add QSD\n                </NavLink>\n              }\n            />\n            <TopBorderBox\n              title='Bonded LP APR'\n              body={\n                <>\n                  <div>LP Daily: {lpDailyYield} </div>\n                  <div>LP Weekly: {lpWeeklyYield} </div>\n                  <div>LP Monthly: {lpMonthlyYield} </div>\n                </>\n              }\n              action={\n                <NavLink component={Button} to='/lp' {...{ external: false }}>\n                  Add LP\n                </NavLink>\n              }\n            />\n          </Row>\n        </Section>\n\n        <Section>\n          <Regulation user={user} hideHistory />\n          <div style={{ textAlign: 'center', marginTop: 22 }}>\n            <NavLink\n              component={Button}\n              to='/regulation'\n              {...{ external: false }}\n            >\n              View more\n            </NavLink>\n          </div>\n        </Section>\n      </div>\n      {/*Commented By RDN*/}\n      {/* </Layout> */}\n      </BContainer>\n      \n  );\n}\n\nfunction Section(props: ComponentProps<'div'>) {\n  return <div style={{ marginTop: 80 }} {...props} />;\n}\n\nexport default HomePage;\n"]},"metadata":{},"sourceType":"module"}