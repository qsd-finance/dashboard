{"ast":null,"code":"import _regeneratorRuntime from\"/Users/J/crypto/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/J/crypto/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/J/crypto/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{DataView,useTheme}from'@aragon/ui';import{getAllRegulations}from'../../utils/infura';import{QSD,QSDS}from'../../constants/tokens';import{formatBN,toTokenUnitsBN}from'../../utils/number';import BigNumber from'bignumber.js';function formatPrice(type,data){return type==='NEUTRAL'?'1.00':formatBN(toTokenUnitsBN(new BigNumber(data.price),QSD.decimals),3);}function formatDeltaBonded(type,data){return type==='INCREASE'?'+'+formatBN(toTokenUnitsBN(new BigNumber(data.newBonded),QSD.decimals),2):'+0.00';}function renderEntry(_ref){var type=_ref.type,data=_ref.data;return[data.epoch.toString(),formatPrice(type,data),formatDeltaBonded(type,data)];}function RegulationHistory(_ref2){var user=_ref2.user;var theme=useTheme();var isDark=theme._name==='dark';var _useState=useState([]),_useState2=_slicedToArray(_useState,2),regulations=_useState2[0],setRegulations=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),page=_useState4[0],setPage=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),initialized=_useState6[0],setInitialized=_useState6[1];//Update User balances\nuseEffect(function(){var isCancelled=false;function updateUserInfo(){return _updateUserInfo.apply(this,arguments);}function _updateUserInfo(){_updateUserInfo=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$Promise$all,_yield$Promise$all2,allRegulations;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all([getAllRegulations(QSDS.addr)]);case 2:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,1);allRegulations=_yield$Promise$all2[0];if(!isCancelled){setRegulations(allRegulations);setInitialized(true);}case 6:case\"end\":return _context.stop();}}},_callee);}));return _updateUserInfo.apply(this,arguments);}updateUserInfo();var id=setInterval(updateUserInfo,15000);// eslint-disable-next-line consistent-return\nreturn function(){isCancelled=true;clearInterval(id);};},[user]);return/*#__PURE__*/React.createElement(\"div\",{className:isDark?'table-container-dark':undefined},/*#__PURE__*/React.createElement(DataView,{fields:['Epoch','Price','Δ Supply'],status:initialized?'default':'loading',entries:regulations,entriesPerPage:10,page:page,onPageChange:setPage,renderEntry:renderEntry}));}export default RegulationHistory;","map":{"version":3,"sources":["/Users/J/crypto/dashboard/src/components/Regulation/RegulationHistory.tsx"],"names":["React","useEffect","useState","DataView","useTheme","getAllRegulations","QSD","QSDS","formatBN","toTokenUnitsBN","BigNumber","formatPrice","type","data","price","decimals","formatDeltaBonded","newBonded","renderEntry","epoch","toString","RegulationHistory","user","theme","isDark","_name","regulations","setRegulations","page","setPage","initialized","setInitialized","isCancelled","updateUserInfo","Promise","all","addr","allRegulations","id","setInterval","clearInterval","undefined"],"mappings":"6aAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,QAAT,CAAmBC,QAAnB,KAAmC,YAAnC,CAEA,OAASC,iBAAT,KAAkC,oBAAlC,CACA,OAASC,GAAT,CAAcC,IAAd,KAA0B,wBAA1B,CACA,OAASC,QAAT,CAAmBC,cAAnB,KAAyC,oBAAzC,CACA,MAAOC,CAAAA,SAAP,KAAsB,cAAtB,CAmBA,QAASC,CAAAA,WAAT,CAAqBC,IAArB,CAA2BC,IAA3B,CAAiC,CAC/B,MAAOD,CAAAA,IAAI,GAAK,SAAT,CACH,MADG,CAEHJ,QAAQ,CAACC,cAAc,CAAC,GAAIC,CAAAA,SAAJ,CAAcG,IAAI,CAACC,KAAnB,CAAD,CAA4BR,GAAG,CAACS,QAAhC,CAAf,CAA0D,CAA1D,CAFZ,CAGD,CAED,QAASC,CAAAA,iBAAT,CAA2BJ,IAA3B,CAAiCC,IAAjC,CAAuC,CACrC,MAAOD,CAAAA,IAAI,GAAK,UAAT,CACH,IACEJ,QAAQ,CAACC,cAAc,CAAC,GAAIC,CAAAA,SAAJ,CAAcG,IAAI,CAACI,SAAnB,CAAD,CAAgCX,GAAG,CAACS,QAApC,CAAf,CAA8D,CAA9D,CAFP,CAGH,OAHJ,CAID,CAED,QAASG,CAAAA,WAAT,MAA2D,IAApCN,CAAAA,IAAoC,MAApCA,IAAoC,CAA9BC,IAA8B,MAA9BA,IAA8B,CACzD,MAAO,CACLA,IAAI,CAACM,KAAL,CAAWC,QAAX,EADK,CAELT,WAAW,CAACC,IAAD,CAAOC,IAAP,CAFN,CAGLG,iBAAiB,CAACJ,IAAD,CAAOC,IAAP,CAHZ,CAAP,CAKD,CAED,QAASQ,CAAAA,iBAAT,OAA6D,IAAhCC,CAAAA,IAAgC,OAAhCA,IAAgC,CAC3D,GAAMC,CAAAA,KAAK,CAAGnB,QAAQ,EAAtB,CACA,GAAMoB,CAAAA,MAAM,CAAGD,KAAK,CAACE,KAAN,GAAgB,MAA/B,CAF2D,cAGrBvB,QAAQ,CAAe,EAAf,CAHa,wCAGpDwB,WAHoD,eAGvCC,cAHuC,8BAInCzB,QAAQ,CAAC,CAAD,CAJ2B,yCAIpD0B,IAJoD,eAI9CC,OAJ8C,8BAKrB3B,QAAQ,CAAC,KAAD,CALa,yCAKpD4B,WALoD,eAKvCC,cALuC,eAO3D;AACA9B,SAAS,CAAC,UAAM,CACd,GAAI+B,CAAAA,WAAW,CAAG,KAAlB,CADc,QAGCC,CAAAA,cAHD,oJAGd,mNACiCC,CAAAA,OAAO,CAACC,GAAR,CAAY,CACzC9B,iBAAiB,CAACE,IAAI,CAAC6B,IAAN,CADwB,CAAZ,CADjC,kGACSC,cADT,wBAKE,GAAI,CAACL,WAAL,CAAkB,CAChBL,cAAc,CAACU,cAAD,CAAd,CACAN,cAAc,CAAC,IAAD,CAAd,CACD,CARH,sDAHc,iDAcdE,cAAc,GACd,GAAMK,CAAAA,EAAE,CAAGC,WAAW,CAACN,cAAD,CAAiB,KAAjB,CAAtB,CAEA;AACA,MAAO,WAAM,CACXD,WAAW,CAAG,IAAd,CACAQ,aAAa,CAACF,EAAD,CAAb,CACD,CAHD,CAID,CAtBQ,CAsBN,CAAChB,IAAD,CAtBM,CAAT,CAwBA,mBACE,2BAAK,SAAS,CAAEE,MAAM,CAAG,sBAAH,CAA4BiB,SAAlD,eACE,oBAAC,QAAD,EACE,MAAM,CAAE,CAAC,OAAD,CAAU,OAAV,CAAmB,UAAnB,CADV,CAEE,MAAM,CAAEX,WAAW,CAAG,SAAH,CAAe,SAFpC,CAGE,OAAO,CAAEJ,WAHX,CAIE,cAAc,CAAE,EAJlB,CAKE,IAAI,CAAEE,IALR,CAME,YAAY,CAAEC,OANhB,CAOE,WAAW,CAAEX,WAPf,EADF,CADF,CAaD,CAED,cAAeG,CAAAA,iBAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { DataView, useTheme } from '@aragon/ui';\n\nimport { getAllRegulations } from '../../utils/infura';\nimport { QSD, QSDS } from '../../constants/tokens';\nimport { formatBN, toTokenUnitsBN } from '../../utils/number';\nimport BigNumber from 'bignumber.js';\n\ntype RegulationHistoryProps = {\n  user: string;\n};\n\ntype Regulation = {\n  type: string;\n  data: RegulationEntry;\n};\n\ntype RegulationEntry = {\n  epoch: string;\n  price: string;\n  deltaRedeemable: string;\n  deltaDebt: string;\n  deltaBonded: string;\n};\n\nfunction formatPrice(type, data) {\n  return type === 'NEUTRAL'\n    ? '1.00'\n    : formatBN(toTokenUnitsBN(new BigNumber(data.price), QSD.decimals), 3);\n}\n\nfunction formatDeltaBonded(type, data) {\n  return type === 'INCREASE'\n    ? '+' +\n        formatBN(toTokenUnitsBN(new BigNumber(data.newBonded), QSD.decimals), 2)\n    : '+0.00';\n}\n\nfunction renderEntry({ type, data }: Regulation): string[] {\n  return [\n    data.epoch.toString(),\n    formatPrice(type, data),\n    formatDeltaBonded(type, data),\n  ];\n}\n\nfunction RegulationHistory({ user }: RegulationHistoryProps) {\n  const theme = useTheme();\n  const isDark = theme._name === 'dark';\n  const [regulations, setRegulations] = useState<Regulation[]>([]);\n  const [page, setPage] = useState(0);\n  const [initialized, setInitialized] = useState(false);\n\n  //Update User balances\n  useEffect(() => {\n    let isCancelled = false;\n\n    async function updateUserInfo() {\n      const [allRegulations] = await Promise.all([\n        getAllRegulations(QSDS.addr),\n      ]);\n\n      if (!isCancelled) {\n        setRegulations(allRegulations);\n        setInitialized(true);\n      }\n    }\n\n    updateUserInfo();\n    const id = setInterval(updateUserInfo, 15000);\n\n    // eslint-disable-next-line consistent-return\n    return () => {\n      isCancelled = true;\n      clearInterval(id);\n    };\n  }, [user]);\n\n  return (\n    <div className={isDark ? 'table-container-dark' : undefined}>\n      <DataView\n        fields={['Epoch', 'Price', 'Δ Supply']}\n        status={initialized ? 'default' : 'loading'}\n        entries={regulations}\n        entriesPerPage={10}\n        page={page}\n        onPageChange={setPage}\n        renderEntry={renderEntry}\n      />\n    </div>\n  );\n}\n\nexport default RegulationHistory;\n"]},"metadata":{},"sourceType":"module"}