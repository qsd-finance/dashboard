{"ast":null,"code":"import _slicedToArray from\"/Users/J/crypto/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Tabs,Button,IconArrowUp,IconCirclePlus,useTheme}from'@aragon/ui';import BigNumber from'bignumber.js';import{BalanceBlock,MaxButton,PriceSection,TopBorderSection}from'../common';import{approve,providePool,providePoolOptimalOneSided}from'../../utils/web3';import{isPos,toBaseUnitBN,toTokenUnitsBN}from'../../utils/number';import{QSD,DAI}from'../../constants/tokens';import{MAX_UINT256}from'../../constants/values';import BigNumberInput from'../common/BigNumberInput';function Provide(_ref){var poolAddress=_ref.poolAddress,user=_ref.user,rewarded=_ref.rewarded,pairBalanceQSD=_ref.pairBalanceQSD,pairBalanceDAI=_ref.pairBalanceDAI,userDAIBalance=_ref.userDAIBalance,userDAIAllowance=_ref.userDAIAllowance,status=_ref.status;var theme=useTheme();var isDark=theme._name==='dark';var _useState=useState(0),_useState2=_slicedToArray(_useState,2),useQSD=_useState2[0],setUseQSD=_useState2[1];var _useState3=useState(new BigNumber(0)),_useState4=_slicedToArray(_useState3,2),provideAmount=_useState4[0],setProvideAmount=_useState4[1];var _useState5=useState(new BigNumber(0)),_useState6=_slicedToArray(_useState5,2),usdcAmount=_useState6[0],setUsdcAmount=_useState6[1];var DAIToQSDRatio=pairBalanceDAI.isZero()?new BigNumber(1):pairBalanceDAI.div(pairBalanceQSD);var onChangeAmountQSD=function onChangeAmountQSD(amountQSD){if(!amountQSD){setProvideAmount(new BigNumber(0));setUsdcAmount(new BigNumber(0));return;}var amountQSDBN=new BigNumber(amountQSD);setProvideAmount(amountQSDBN);var amountQSDBU=toBaseUnitBN(amountQSDBN,QSD.decimals);var newAmountDAI=toTokenUnitsBN(amountQSDBU.multipliedBy(DAIToQSDRatio).integerValue(BigNumber.ROUND_FLOOR),QSD.decimals);setUsdcAmount(newAmountDAI);};return/*#__PURE__*/React.createElement(TopBorderSection,{title:\"Provide\"},/*#__PURE__*/React.createElement(\"div\",{style:{width:'auto',margin:'0 auto'},className:isDark?'tabs-container-dark':undefined},/*#__PURE__*/React.createElement(Tabs,{items:['Dual Supply (with DAI)','Single Supply'],selected:useQSD,onChange:setUseQSD})),userDAIAllowance.comparedTo(MAX_UINT256.dividedBy(2))>0||useQSD?/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',flexWrap:'wrap'}},/*#__PURE__*/React.createElement(\"div\",{style:{flexBasis:'32%'}},/*#__PURE__*/React.createElement(BalanceBlock,{asset:\"Rewarded\",balance:rewarded,suffix:'QSD'})),/*#__PURE__*/React.createElement(\"div\",{style:{flexBasis:'35%'}}),/*#__PURE__*/React.createElement(\"div\",{style:{flexBasis:'33%',paddingTop:'2%'}},/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex'}},/*#__PURE__*/React.createElement(\"div\",{style:{width:'60%',minWidth:'6em'}},/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(BigNumberInput,{adornment:\"QSD\",value:provideAmount,setter:onChangeAmountQSD,disabled:status===1}),!useQSD&&/*#__PURE__*/React.createElement(PriceSection,{label:\"Requires \",amt:usdcAmount,symbol:\" DAI\"}),/*#__PURE__*/React.createElement(MaxButton,{onClick:function onClick(){onChangeAmountQSD(rewarded);}}))),/*#__PURE__*/React.createElement(\"div\",{style:{width:'40%',minWidth:'6em'}},/*#__PURE__*/React.createElement(Button,{wide:true,icon:/*#__PURE__*/React.createElement(IconArrowUp,null),label:\"Provide\",onClick:function onClick(){if(useQSD){providePoolOptimalOneSided(poolAddress,toBaseUnitBN(provideAmount,QSD.decimals),function(hash){return setProvideAmount(new BigNumber(0));});}else{providePool(poolAddress,toBaseUnitBN(provideAmount,QSD.decimals),function(hash){return setProvideAmount(new BigNumber(0));});}},disabled:poolAddress===''||status!==0||!isPos(provideAmount)||provideAmount.isGreaterThan(rewarded)}))))):/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex',flexWrap:'wrap'}},/*#__PURE__*/React.createElement(\"div\",{style:{flexBasis:'32%'}},/*#__PURE__*/React.createElement(BalanceBlock,{asset:\"Rewarded\",balance:rewarded,suffix:'QSD'})),/*#__PURE__*/React.createElement(\"div\",{style:{flexBasis:'33%'}},/*#__PURE__*/React.createElement(BalanceBlock,{asset:\"DAI Balance\",balance:userDAIBalance,suffix:'DAI'})),/*#__PURE__*/React.createElement(\"div\",{style:{flexBasis:'2%'}}),/*#__PURE__*/React.createElement(\"div\",{style:{flexBasis:'33%',paddingTop:'2%'}},/*#__PURE__*/React.createElement(Button,{wide:true,icon:/*#__PURE__*/React.createElement(IconCirclePlus,null),label:\"Approve\",onClick:function onClick(){approve(DAI.addr,poolAddress);},disabled:poolAddress===''||user===''}))),/*#__PURE__*/React.createElement(\"div\",{style:{width:'100%',paddingTop:'2%',textAlign:'center'}},/*#__PURE__*/React.createElement(\"span\",{style:{opacity:0.5}},useQSD?'Zap your rewards directly':'Zap your rewards directly to LP by providing more DAI')));}export default Provide;","map":{"version":3,"sources":["/Users/J/crypto/dashboard/src/components/Pool/Provide.tsx"],"names":["React","useState","Tabs","Button","IconArrowUp","IconCirclePlus","useTheme","BigNumber","BalanceBlock","MaxButton","PriceSection","TopBorderSection","approve","providePool","providePoolOptimalOneSided","isPos","toBaseUnitBN","toTokenUnitsBN","QSD","DAI","MAX_UINT256","BigNumberInput","Provide","poolAddress","user","rewarded","pairBalanceQSD","pairBalanceDAI","userDAIBalance","userDAIAllowance","status","theme","isDark","_name","useQSD","setUseQSD","provideAmount","setProvideAmount","usdcAmount","setUsdcAmount","DAIToQSDRatio","isZero","div","onChangeAmountQSD","amountQSD","amountQSDBN","amountQSDBU","decimals","newAmountDAI","multipliedBy","integerValue","ROUND_FLOOR","width","margin","undefined","comparedTo","dividedBy","display","flexWrap","flexBasis","paddingTop","minWidth","hash","isGreaterThan","addr","textAlign","opacity"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport {\n  Tabs,\n  Button,\n  IconArrowUp,\n  IconCirclePlus,\n  useTheme,\n} from '@aragon/ui';\nimport BigNumber from 'bignumber.js';\nimport {\n  BalanceBlock,\n  MaxButton,\n  PriceSection,\n  TopBorderSection,\n} from '../common';\nimport {\n  approve,\n  providePool,\n  providePoolOptimalOneSided,\n} from '../../utils/web3';\nimport { isPos, toBaseUnitBN, toTokenUnitsBN } from '../../utils/number';\nimport { QSD, DAI } from '../../constants/tokens';\nimport { MAX_UINT256 } from '../../constants/values';\nimport BigNumberInput from '../common/BigNumberInput';\n\ntype ProvideProps = {\n  poolAddress: string;\n  user: string;\n  rewarded: BigNumber;\n  pairBalanceQSD: BigNumber;\n  pairBalanceDAI: BigNumber;\n  userDAIBalance: BigNumber;\n  userDAIAllowance: BigNumber;\n  status: number;\n};\n\nfunction Provide({\n  poolAddress,\n  user,\n  rewarded,\n  pairBalanceQSD,\n  pairBalanceDAI,\n  userDAIBalance,\n  userDAIAllowance,\n  status,\n}: ProvideProps) {\n  const theme = useTheme();\n  const isDark = theme._name === 'dark';\n  const [useQSD, setUseQSD] = useState(0);\n  const [provideAmount, setProvideAmount] = useState(new BigNumber(0));\n  const [usdcAmount, setUsdcAmount] = useState(new BigNumber(0));\n\n  const DAIToQSDRatio = pairBalanceDAI.isZero()\n    ? new BigNumber(1)\n    : pairBalanceDAI.div(pairBalanceQSD);\n\n  const onChangeAmountQSD = (amountQSD) => {\n    if (!amountQSD) {\n      setProvideAmount(new BigNumber(0));\n      setUsdcAmount(new BigNumber(0));\n      return;\n    }\n\n    const amountQSDBN = new BigNumber(amountQSD);\n    setProvideAmount(amountQSDBN);\n\n    const amountQSDBU = toBaseUnitBN(amountQSDBN, QSD.decimals);\n    const newAmountDAI = toTokenUnitsBN(\n      amountQSDBU\n        .multipliedBy(DAIToQSDRatio)\n        .integerValue(BigNumber.ROUND_FLOOR),\n      QSD.decimals\n    );\n    setUsdcAmount(newAmountDAI);\n  };\n\n  return (\n    <TopBorderSection title='Provide'>\n      <div\n        style={{ width: 'auto', margin: '0 auto' }}\n        className={isDark ? 'tabs-container-dark' : undefined}\n      >\n        <Tabs\n          items={['Dual Supply (with DAI)', 'Single Supply']}\n          selected={useQSD}\n          onChange={setUseQSD}\n        />\n      </div>\n      {userDAIAllowance.comparedTo(MAX_UINT256.dividedBy(2)) > 0 || useQSD ? (\n        <div style={{ display: 'flex', flexWrap: 'wrap' }}>\n          {/* total rewarded */}\n          <div style={{ flexBasis: '32%' }}>\n            <BalanceBlock asset='Rewarded' balance={rewarded} suffix={'QSD'} />\n          </div>\n          <div style={{ flexBasis: '35%' }}></div>\n          {/* Provide liquidity using Pool rewards */}\n          <div style={{ flexBasis: '33%', paddingTop: '2%' }}>\n            <div style={{ display: 'flex' }}>\n              <div style={{ width: '60%', minWidth: '6em' }}>\n                <>\n                  <BigNumberInput\n                    adornment='QSD'\n                    value={provideAmount}\n                    setter={onChangeAmountQSD}\n                    disabled={status === 1}\n                  />\n                  {!useQSD && (\n                    <PriceSection\n                      label='Requires '\n                      amt={usdcAmount}\n                      symbol=' DAI'\n                    />\n                  )}\n                  <MaxButton\n                    onClick={() => {\n                      onChangeAmountQSD(rewarded);\n                    }}\n                  />\n                </>\n              </div>\n              <div style={{ width: '40%', minWidth: '6em' }}>\n                <Button\n                  wide\n                  icon={<IconArrowUp />}\n                  label='Provide'\n                  onClick={() => {\n                    if (useQSD) {\n                      providePoolOptimalOneSided(\n                        poolAddress,\n                        toBaseUnitBN(provideAmount, QSD.decimals),\n                        (hash) => setProvideAmount(new BigNumber(0))\n                      );\n                    } else {\n                      providePool(\n                        poolAddress,\n                        toBaseUnitBN(provideAmount, QSD.decimals),\n                        (hash) => setProvideAmount(new BigNumber(0))\n                      );\n                    }\n                  }}\n                  disabled={\n                    poolAddress === '' ||\n                    status !== 0 ||\n                    !isPos(provideAmount) ||\n                    provideAmount.isGreaterThan(rewarded)\n                  }\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      ) : (\n        <div style={{ display: 'flex', flexWrap: 'wrap' }}>\n          {/* total rewarded */}\n          <div style={{ flexBasis: '32%' }}>\n            <BalanceBlock asset='Rewarded' balance={rewarded} suffix={'QSD'} />\n          </div>\n          <div style={{ flexBasis: '33%' }}>\n            <BalanceBlock\n              asset='DAI Balance'\n              balance={userDAIBalance}\n              suffix={'DAI'}\n            />\n          </div>\n          <div style={{ flexBasis: '2%' }} />\n          {/* Approve Pool to spend DAI */}\n          <div style={{ flexBasis: '33%', paddingTop: '2%' }}>\n            <Button\n              wide\n              icon={<IconCirclePlus />}\n              label='Approve'\n              onClick={() => {\n                approve(DAI.addr, poolAddress);\n              }}\n              disabled={poolAddress === '' || user === ''}\n            />\n          </div>\n        </div>\n      )}\n      <div style={{ width: '100%', paddingTop: '2%', textAlign: 'center' }}>\n        <span style={{ opacity: 0.5 }}>\n          {useQSD\n            ? 'Zap your rewards directly'\n            : 'Zap your rewards directly to LP by providing more DAI'}\n        </span>\n      </div>\n    </TopBorderSection>\n  );\n}\n\nexport default Provide;\n"]},"metadata":{},"sourceType":"module"}